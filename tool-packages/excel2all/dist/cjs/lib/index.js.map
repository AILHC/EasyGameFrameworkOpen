{"version":3,"file":"index.js","sources":["@ailhc/excel2all/src/default-value-func-map.ts","@ailhc/excel2all/src/get-os-eol.ts","@ailhc/excel2all/src/loger.ts","@ailhc/excel2all/src/table-utils.ts","@ailhc/excel2all/src/default-parse-handler.ts","@ailhc/excel2all/src/default-convert-hook.ts","@ailhc/excel2all/src/default-output-transformer.ts","@ailhc/excel2all/src/do-parse.ts","@ailhc/excel2all/src/file-utils.ts","E:/FrameWorkSpace/EasyGameFrameworkOpen/node_modules/braces/lib/utils.js","E:/FrameWorkSpace/EasyGameFrameworkOpen/node_modules/picomatch/lib/constants.js","E:/FrameWorkSpace/EasyGameFrameworkOpen/node_modules/picomatch/lib/utils.js","@ailhc/excel2all/src/convert.ts"],"sourcesContent":["import { Logger } from \"./loger\";\n\nexport const valueTransFuncMap: {\n    [key: string]: ValueTransFunc;\n} = {};\nvalueTransFuncMap[\"int\"] = strToInt;\nvalueTransFuncMap[\"string\"] = anyToStr;\nvalueTransFuncMap[\"[int]\"] = strToIntArr;\nvalueTransFuncMap[\"[string]\"] = strToStrArr;\nvalueTransFuncMap[\"json\"] = strToJsonObj;\nvalueTransFuncMap[\"json\"] = anyToAny;\nfunction strToIntArr(fieldItem: ITableField, cellValue: string): ITransValueResult {\n    cellValue = (cellValue + \"\").replace(/，/g, \",\"); //为了防止策划误填，先进行转换\n    cellValue = cellValue.trim();\n    let intArr: number[];\n    const result: ITransValueResult = {};\n    if (cellValue !== \"\") {\n        try {\n            intArr = JSON.parse(cellValue);\n            result.value = intArr;\n        } catch (error) {\n            result.error = error;\n        }\n    }\n\n    return result;\n}\nfunction strToStrArr(fieldItem: ITableField, cellValue: string): ITransValueResult {\n    cellValue = (cellValue + \"\").replace(/，/g, \",\"); //为了防止策划误填，先进行转换\n    cellValue = cellValue.trim();\n    let result: ITransValueResult = {};\n    let arr: string[];\n    if (cellValue !== \"\") {\n        try {\n            arr = JSON.parse(cellValue);\n            result.value = arr;\n        } catch (error) {\n            result.error = error;\n        }\n    }\n    return result;\n}\nfunction strToInt(fieldItem: ITableField, cellValue: string): ITransValueResult {\n    let result: ITransValueResult = {} as any;\n    if (typeof cellValue === \"string\" && cellValue.trim() !== \"\") {\n        result.value = cellValue.includes(\".\") ? parseFloat(cellValue) : (parseInt(cellValue) as any);\n    } else if (typeof cellValue === \"number\") {\n        result.value = cellValue;\n    }\n    return result;\n}\nfunction strToJsonObj(fieldItem: ITableField, cellValue: string): ITransValueResult {\n    cellValue = (cellValue + \"\").replace(/，/g, \",\"); //为了防止策划误填，先进行转换\n    cellValue = cellValue.trim();\n    let obj;\n    let error;\n    if (cellValue !== \"\") {\n        try {\n            obj = JSON.parse(cellValue);\n        } catch (err) {\n            error = err;\n            obj = cellValue;\n        }\n    }\n    return { error: error, value: obj };\n}\nfunction anyToStr(fieldItem: ITableField, cellValue: any): ITransValueResult {\n    let result: ITransValueResult = {} as any;\n    if (typeof cellValue === \"string\") {\n        cellValue = cellValue.trim();\n        if (cellValue !== \"\") {\n            result.value = cellValue;\n        }\n    } else {\n        result.value = cellValue + \"\";\n    }\n    return result;\n}\n/**\n * 先尝试转换未对象，不行再使用原值\n * @param fieldItem\n * @param cellValue\n * @returns\n */\nfunction anyToAny(fieldItem: ITableField, cellValue: string): ITransValueResult {\n    cellValue = (cellValue + \"\").replace(/，/g, \",\"); //为了防止策划误填，先进行转换\n    cellValue = cellValue.trim();\n    let obj;\n    let error;\n    if (cellValue !== \"\") {\n        try {\n            obj = JSON.parse(cellValue);\n        } catch (err) {\n            obj = cellValue;\n        }\n    }\n    return { error: error, value: obj };\n}\n","import * as os from \"os\";\nconst platform = os.platform();\n/**当前系统行尾  platform === \"win32\" ? \"\\n\" : \"\\r\\n\";*/\nexport const osEol = platform === \"win32\" ? \"\\n\" : \"\\r\\n\";\n","import { osEol } from \"./get-os-eol\";\nimport * as path from \"path\";\nenum LogLevelEnum {\n    info,\n    warn,\n    error,\n    no\n}\nexport class Logger {\n    private static _enableOutPutLogFile: boolean;\n    private static _logLevel: LogLevelEnum;\n    private static _logStr: string = \"\";\n    /**\n     * 如果有输出过错误信息则为true\n     */\n    public static hasError: boolean = false;\n    public static init(convertConfig: ITableConvertConfig) {\n        const level: LogLevel = convertConfig.logLevel ? convertConfig.logLevel : \"info\";\n        this._logLevel = LogLevelEnum[level];\n        this._enableOutPutLogFile = convertConfig.outputLogDirPath === false ? false : true;\n    }\n    /**\n     * 输出日志,日志等级只是限制了控制台输出，但不限制日志记录\n     * @param message\n     * @param level\n     */\n    public static log(message: string, level: LogLevel = \"info\") {\n        if (level !== \"no\") {\n            if (this._logLevel <= LogLevelEnum[level]) {\n                switch (level) {\n                    case \"error\":\n                        console.error(message);\n                        if (!this.hasError) this.hasError = true;\n                        break;\n                    case \"info\":\n                        console.log(message);\n                        break;\n                    case \"warn\":\n                        console.warn(message);\n                        break;\n                }\n            }\n        }\n\n        if (!this._enableOutPutLogFile) return;\n        this._logStr += message + osEol;\n    }\n    /**\n     * 系统日志输出\n     * @param args\n     */\n    public static systemLog(message: string) {\n        console.log(message);\n        if (!this._enableOutPutLogFile) return;\n        this._logStr += message + osEol;\n    }\n    /**\n     * 返回日志数据并清空\n     */\n    public static get logStr(): string {\n        if (!this._enableOutPutLogFile) return null;\n        const logStr = this._logStr;\n        this._logStr = \"\"; //清空\n        return logStr;\n    }\n}\n","import * as xlsx from \"xlsx\";\n/**\n * 是否为空表格格子\n * @param cell\n */\nexport function isEmptyCell(cell: xlsx.CellObject) {\n    if (cell && cell.v !== undefined) {\n        if (typeof cell.v === \"string\") {\n            return cell.v === \"\";\n        } else if (typeof cell.v === \"number\") {\n            return isNaN(cell.v);\n        } else {\n            return false;\n        }\n    } else {\n        return true;\n    }\n}\n/**\n * 字母Z的编码\n */\nexport const ZCharCode = 90;\n/**\n * 字母A的编码\n *\n */\nexport const ACharCode = 65;\n/**\n * 根据当前列的charCodes获取下一列Key\n * @param charCodes\n */\nexport function getNextColKey(charCodes: number[]): string {\n    let isAdd: boolean;\n    for (let i = charCodes.length - 1; i >= 0; i--) {\n        if (charCodes[i] < ZCharCode) {\n            charCodes[i] += 1;\n            isAdd = true;\n            break;\n        } else if (charCodes[i] === ZCharCode) {\n            charCodes[i] = ACharCode;\n        }\n    }\n    if (!isAdd) {\n        charCodes.push(ACharCode);\n    }\n\n    return charCodesToString(charCodes);\n}\n\n/**\n * 列的字符编码数组转字符串\n * @param charCodes\n */\nexport function charCodesToString(charCodes: number[]): string {\n    return String.fromCharCode(...charCodes);\n}\n/**\n * 字符串转编码数组\n * @param colKey\n */\nexport function stringToCharCodes(colKey: string) {\n    const charCodes = [];\n    for (let i = 0; i < colKey.length; i++) {\n        charCodes.push(colKey.charCodeAt(i));\n    }\n    return charCodes;\n}\n/**\n * 纵向遍历表格\n * @param sheet xlsx表格对象\n * @param startRow 开始行 从1开始\n * @param startCol 列字符 比如A B\n * @param callback 遍历回调 (sheet: xlsx.Sheet, colKey: string, rowIndex: number) => void\n * @param isSheetRowEnd 是否行结束判断方法\n * @param isSheetColEnd 是否列结束判断方法\n * @param isSkipSheetRow 是否跳过行\n * @param isSkipSheetCol 是否跳过列\n */\nexport function verticalForEachSheet(\n    sheet: xlsx.Sheet,\n    startRow: number,\n    startCol: string,\n    callback: (sheet: xlsx.Sheet, colKey: string, rowIndex: number) => void,\n    isSheetRowEnd?: (sheet: xlsx.Sheet, rowIndex: number) => boolean,\n    isSheetColEnd?: (sheet: xlsx.Sheet, colkey: string) => boolean,\n    isSkipSheetRow?: (sheet: xlsx.Sheet, rowIndex: number) => boolean,\n    isSkipSheetCol?: (sheet: xlsx.Sheet, colKey: string) => boolean\n) {\n    const sheetRef: string = sheet[\"!ref\"];\n    const maxRowNum = parseInt(sheetRef.match(/\\d+$/)[0]);\n\n    const maxColKey = sheetRef.split(\":\")[1].match(/^[A-Za-z]+/)[0];\n    let maxColKeyCodeSum = getCharCodeSum(maxColKey);\n\n    let colCharCodes: number[];\n    let colKey: string;\n    let curColCodeSum: number = 0;\n    const startCharcodes = stringToCharCodes(startCol);\n    for (let i = startRow; i <= maxRowNum; i++) {\n        if (isSheetRowEnd ? isSheetRowEnd(sheet, i) : false) break;\n        if (isSkipSheetRow ? isSkipSheetRow(sheet, i) : false) continue;\n        colCharCodes = startCharcodes.concat([]);\n\n        colKey = startCol;\n\n        let hasNextCol = isSheetColEnd ? !isSheetColEnd(sheet, colKey) : true;\n        while (hasNextCol) {\n            if (!(isSkipSheetCol ? isSkipSheetCol(sheet, colKey) : false)) {\n                callback(sheet, colKey, i);\n            }\n            colKey = getNextColKey(colCharCodes);\n            curColCodeSum = getCharCodeSum(colKey);\n            if (maxColKeyCodeSum >= curColCodeSum) {\n                hasNextCol = isSheetColEnd ? !isSheetColEnd(sheet, colKey) : true;\n            } else {\n                hasNextCol = false;\n            }\n        }\n    }\n}\n\n/**\n * 横向遍历表格\n * @param sheet xlsx表格对象\n * @param startRow 开始行 从1开始\n * @param startCol 列字符 比如A B\n * @param callback 遍历回调 (sheet: xlsx.Sheet, colKey: string, rowIndex: number) => void\n * @param isSheetRowEnd 是否行结束判断方法\n * @param isSheetColEnd 是否列结束判断方法\n * @param isSkipSheetRow 是否跳过行\n * @param isSkipSheetCol 是否跳过列\n */\nexport function horizontalForEachSheet(\n    sheet: xlsx.Sheet,\n    startRow: number,\n    startCol: string,\n    callback: (sheet: xlsx.Sheet, colKey: string, rowIndex: number) => void,\n    isSheetRowEnd?: (sheet: xlsx.Sheet, rowIndex: number) => boolean,\n    isSheetColEnd?: (sheet: xlsx.Sheet, colkey: string) => boolean,\n    isSkipSheetRow?: (sheet: xlsx.Sheet, rowIndex: number) => boolean,\n    isSkipSheetCol?: (sheet: xlsx.Sheet, colKey: string) => boolean\n) {\n    const sheetRef: string = sheet[\"!ref\"];\n    const maxRowNum = parseInt(sheetRef.match(/\\d+$/)[0]);\n\n    const maxColKey = sheetRef.split(\":\")[1].match(/^[A-Za-z]+/)[0];\n    const maxColKeyCodeSum = getCharCodeSum(maxColKey);\n    let colCharCodes: number[];\n    let colKey: string;\n    colCharCodes = stringToCharCodes(startCol);\n    let curColCodeSum: number = 0;\n    colKey = startCol;\n    let hasNextCol = isSheetColEnd ? !isSheetColEnd(sheet, colKey) : true;\n    while (hasNextCol) {\n        if (!(isSkipSheetCol ? isSkipSheetCol(sheet, colKey) : false)) {\n            for (let i = startRow; i <= maxRowNum; i++) {\n                if (isSheetRowEnd ? isSheetRowEnd(sheet, i) : false) break;\n                if (isSkipSheetRow ? isSkipSheetRow(sheet, i) : false) continue;\n                callback(sheet, colKey, i);\n            }\n        }\n\n        colKey = getNextColKey(colCharCodes);\n        curColCodeSum = getCharCodeSum(colKey);\n        if (maxColKeyCodeSum >= curColCodeSum) {\n            hasNextCol = isSheetColEnd ? !isSheetColEnd(sheet, colKey) : true;\n        } else {\n            hasNextCol = false;\n        }\n    }\n}\nlet colKeySumMap = {};\nfunction getCharCodeSum(colKey: string): number {\n    let sum: number = colKeySumMap[colKey];\n    if (!sum) {\n        sum = 0;\n        for (let i = 0; i < colKey.length; i++) {\n            sum += colKey.charCodeAt(i);\n        }\n        colKeySumMap[colKey] = sum;\n    }\n    return sum;\n}\n/**\n * 读取配置表文件 同步的\n * @param fileInfo\n */\nexport function readTableFile(fileInfo: IFileInfo): xlsx.WorkBook {\n    const workBook = xlsx.readFile(fileInfo.filePath, { type: getTableFileType(fileInfo) });\n    return workBook;\n}\n/**\n * 读取配置表文件 同步的\n * @param fileInfo\n */\nexport function readTableData(fileInfo: IFileInfo): xlsx.WorkBook {\n    const workBook = xlsx.read(fileInfo.fileData);\n    return workBook;\n}\n/**\n * 获取配置文件类型\n * @param fileInfo \n * @returns \n */\nexport function getTableFileType(fileInfo: IFileInfo) {\n    return isCSV(fileInfo.fileExtName) ? \"string\" : \"file\"\n}\n/**\n * 根据文件名后缀判断是否为csv文件\n * @param fileExtName\n */\nexport function isCSV(fileExtName: string): boolean {\n    return fileExtName === \"csv\";\n}\n","import * as xlsx from \"xlsx\";\nimport { valueTransFuncMap } from \"./default-value-func-map\";\nimport { Logger } from \"./loger\";\nimport { horizontalForEachSheet, isEmptyCell, readTableData, readTableFile, verticalForEachSheet } from \"./table-utils\";\n\ndeclare global {\n    interface ITableField {\n        /**配置表中注释值 */\n        text: string;\n        /**配置表中类型值 */\n        originType: string;\n        /**配置表中字段名值 */\n        originFieldName: string;\n        /**解析后的类型值 */\n        type?: string;\n        /**解析后的字段名值 */\n        fieldName?: string;\n        /**对象的子字段名 */\n        subFieldName?: string;\n        /**多列对象 */\n        isMutiColObj?: boolean;\n    }\n    interface ITableDefine {\n        /**配置表名 */\n        tableName: string;\n        /**配置表类型 默认两种: vertical 和 horizontal*/\n        tableType: string;\n\n        /**开始行从1开始 */\n        startRow: number;\n        /**开始列从A开始 */\n        startCol: string;\n        /**垂直解析字段定义 */\n        verticalFieldDefine: IVerticalFieldDefine;\n        /**横向解析字段定义 */\n        horizontalFieldDefine: IHorizontalFieldDefine;\n    }\n    interface IHorizontalFieldDefine {\n        /**类型行 */\n        typeCol: string;\n        /**字段名行 */\n        fieldCol: string;\n        /**注释行 */\n        textCol: string;\n    }\n    interface IVerticalFieldDefine {\n        /**类型行 */\n        typeRow: number;\n        /**字段名行 */\n        fieldRow: number;\n        /**注释行 */\n        textRow: number;\n    }\n    /**\n     * 字段字典\n     * key是列colKey\n     * value是字段对象\n     */\n    type ColKeyTableFieldMap = { [key: string]: ITableField };\n\n    /**\n     * 表格的一行或者一列\n     * key为字段名值，value为表格的一格\n     */\n    type TableRowOrCol = { [key: string]: ITableCell };\n    /**\n     * 表格的一格\n     */\n    interface ITableCell {\n        /**字段对象 */\n        filed: ITableField;\n        /**值 */\n        value: any;\n    }\n    /**\n     * 表格行或列的字典\n     * key为行索引，value为表格的一行\n     */\n    type TableRowOrColMap = { [key: string]: TableRowOrCol };\n    /**\n     * 表格行或列值数组\n     * key主键，value是值数组\n     */\n    type RowOrColValuesMap = { [key: string]: any[] };\n    interface ITableValues {\n        /**字段名数组 */\n        fields: string[];\n        /**表格值数组 */\n        rowOrColValuesMap: RowOrColValuesMap;\n    }\n    /**\n     * 解析结果\n     */\n    interface ITableParseResult {\n        /**配置表定义 */\n        tableDefine?: ITableDefine;\n        /**当前分表名 */\n        curSheetName?: string;\n        /**字段字典 */\n        filedMap?: ColKeyTableFieldMap;\n        // /**表格行或列的字典 */\n        // rowOrColMap: TableRowOrColMap\n        /**单个表格对象 */\n        /**key是主键值，value是一行对象 */\n        tableObj?: { [key: string]: any };\n        /**当前行或列对象 */\n        curRowOrColObj?: any;\n        /**主键值 */\n        mainKeyFieldName?: string;\n    }\n\n    /**值转换方法 */\n    interface ITransValueResult {\n        error?: any;\n        value?: any;\n    }\n    type ValueTransFunc = (fieldItem: ITableField, cellValue: any) => ITransValueResult;\n    /**\n     * 值转换方法字典\n     * key是类型key\n     * value是方法\n     */\n    type ValueTransFuncMap = { [key: string]: ValueTransFunc };\n}\nexport enum TableType {\n    vertical = \"vertical\",\n    horizontal = \"horizontal\"\n}\n\nexport class DefaultParseHandler implements ITableParseHandler {\n    private _valueTransFuncMap: ValueTransFuncMap;\n    constructor() {\n        this._valueTransFuncMap = valueTransFuncMap;\n    }\n    getTableDefine(fileInfo: IFileInfo, workBook: xlsx.WorkBook): ITableDefine {\n        let cellKey: string;\n        let cellObj: xlsx.CellObject;\n\n        const sheetNames = workBook.SheetNames;\n        let sheet: xlsx.Sheet;\n        let firstCellValue: { tableNameInSheet: string; tableType: string };\n        let firstCellObj: xlsx.CellObject;\n\n        const tableDefine: Partial<ITableDefine> = {};\n\n        for (let i = 0; i < sheetNames.length; i++) {\n            sheet = workBook.Sheets[sheetNames[i]];\n            firstCellObj = sheet[\"A\" + 1];\n            if (!isEmptyCell(firstCellObj)) {\n                firstCellValue = this._getFirstCellValue(firstCellObj);\n                if (!tableDefine.tableName) {\n                    tableDefine.tableName = firstCellValue.tableNameInSheet;\n                    tableDefine.tableType = firstCellValue.tableType;\n                }\n                if (firstCellValue && firstCellValue.tableNameInSheet === tableDefine.tableName) {\n                    break;\n                }\n            }\n        }\n        if (!tableDefine.tableName || !tableDefine.tableType) {\n            Logger.log(`表格不规范,跳过解析,路径:${fileInfo.filePath}`, \"warn\");\n            return null;\n        }\n        if (tableDefine.tableType === TableType.vertical) {\n            tableDefine.verticalFieldDefine = {} as any;\n            const verticalFieldDefine: IVerticalFieldDefine = tableDefine.verticalFieldDefine;\n            verticalFieldDefine.textRow = 1;\n            for (let i = 1; i < 100; i++) {\n                cellKey = \"A\" + i;\n                cellObj = sheet[cellKey];\n                if (isEmptyCell(cellObj) || cellObj.v === \"NO\" || cellObj.v === \"END\" || cellObj.v === \"START\") {\n                    tableDefine.startRow = i;\n                } else if (cellObj.v === \"CLIENT\") {\n                    verticalFieldDefine.fieldRow = i;\n                } else if (cellObj.v === \"TYPE\") {\n                    verticalFieldDefine.typeRow = i;\n                }\n                if (tableDefine.startRow && verticalFieldDefine.fieldRow && verticalFieldDefine.typeRow) break;\n            }\n\n            tableDefine.startCol = \"B\";\n        } else if (tableDefine.tableType === TableType.horizontal) {\n            tableDefine.horizontalFieldDefine = {} as any;\n            const horizontalFieldDefine = tableDefine.horizontalFieldDefine;\n            horizontalFieldDefine.textCol = \"A\";\n            horizontalFieldDefine.typeCol = \"B\";\n            horizontalFieldDefine.fieldCol = \"C\";\n            tableDefine.startCol = \"E\";\n            tableDefine.startRow = 2;\n        }\n\n        return tableDefine as any;\n    }\n    private _getFirstCellValue(firstCellObj: xlsx.CellObject) {\n        if (!firstCellObj) return;\n        const cellValues = (firstCellObj.v as string).split(\":\");\n        let tableNameInSheet: string;\n        let tableType: string;\n        if (cellValues.length > 1) {\n            tableNameInSheet = cellValues[1];\n            tableType = cellValues[0] === \"H\" ? TableType.horizontal : TableType.vertical;\n        } else {\n            tableNameInSheet = cellValues[0];\n            tableType = TableType.vertical;\n        }\n        return { tableNameInSheet: tableNameInSheet, tableType: tableType };\n    }\n    /**\n     * 判断表格是否能解析\n     * @param sheet\n     */\n    checkSheetCanParse(tableDefine: ITableDefine, sheet: xlsx.Sheet, sheetName: string): boolean {\n        //如果这个表个第一格值不等于表名，则不解析\n        const firstCellObj: xlsx.CellObject = sheet[\"A\" + 1];\n        const firstCellValue = this._getFirstCellValue(firstCellObj);\n        if (firstCellObj && tableDefine) {\n            if (firstCellValue.tableNameInSheet !== tableDefine.tableName) {\n                return false;\n            }\n            return true;\n        } else {\n            return false;\n        }\n    }\n    /**\n     * 表行结束判断\n     * @param tableDefine\n     * @param sheet\n     * @param row\n     */\n    isSheetRowEnd(tableDefine: ITableDefine, sheet: xlsx.Sheet, row: number): boolean {\n        // if (tableDefine.tableType === TableType.vertical) {\n\n        // } else if (tableDefine.tableType === TableType.horizontal) {\n\n        // }\n        //判断上一行的标志是否为END\n        if (row > 1) {\n            row = row - 1;\n            const cellObj: xlsx.CellObject = sheet[\"A\" + row];\n            return cellObj && cellObj.v === \"END\";\n        } else {\n            return false;\n        }\n    }\n    /**\n     * 表列结束判断\n     * @param tableDefine\n     * @param sheet\n     * @param colKey\n     */\n    isSheetColEnd(tableDefine: ITableDefine, sheet: xlsx.Sheet, colKey: string): boolean {\n        //判断这一列第一行是否为空\n        const firstCellObj: xlsx.CellObject = sheet[colKey + 1];\n        // const typeCellObj: xlsx.CellObject = sheet[colKey + tableFile.tableDefine.typeRow];\n        return isEmptyCell(firstCellObj);\n    }\n    /**\n     * 检查行是否需要解析\n     * @param tableDefine\n     * @param sheet\n     * @param rowIndex\n     */\n    checkRowNeedParse(tableDefine: ITableDefine, sheet: xlsx.Sheet, rowIndex: number): boolean {\n        const cellObj: xlsx.CellObject = sheet[\"A\" + rowIndex];\n        if (cellObj && cellObj.v === \"NO\") {\n            return false;\n        }\n        return true;\n    }\n    /**\n     * 解析单个格子\n     * @param tableParseResult\n     * @param sheet\n     * @param colKey\n     * @param rowIndex\n     * @param isNewRowOrCol 是否为新的一行或者一列\n     */\n    parseVerticalCell(\n        tableParseResult: ITableParseResult,\n        sheet: xlsx.Sheet,\n        colKey: string,\n        rowIndex: number,\n        isNewRowOrCol: boolean\n    ): void {\n        const fieldInfo = this.getVerticalTableField(tableParseResult, sheet, colKey, rowIndex);\n        if (!fieldInfo) return;\n        const cell: xlsx.CellObject = sheet[colKey + rowIndex];\n        if (isEmptyCell(cell)) {\n            return;\n        }\n\n        const transResult = this.transValue(tableParseResult, fieldInfo, cell.v);\n        if (transResult.error) {\n            Logger.log(\n                `!!!!!!!!!!!!!!!!!![-----解析错误-----]!!!!!!!!!!!!!!!!!!!!!!!!!\\n` +\n                `[sheetName|分表名]=> ${tableParseResult.curSheetName}\\n` +\n                `[row|行]=> ${rowIndex}\\n` +\n                `[col|列]=> ${colKey}\\n` +\n                `[field|字段]=> ${fieldInfo.originFieldName}\\n` +\n                `[type|类型]=> ${fieldInfo.originType}\\n` +\n                `[error|错误]=> ${typeof transResult.error === \"string\" ? transResult.error : transResult.error.message\n                }\\n`,\n                \"error\"\n            );\n            // Logger.log(transResult.error, \"error\");\n        }\n        const transedValue = transResult.value;\n        let mainKeyFieldName: string = tableParseResult.mainKeyFieldName;\n        if (!mainKeyFieldName) {\n            //第一个字段就是主键\n            mainKeyFieldName = fieldInfo.fieldName;\n            tableParseResult.mainKeyFieldName = fieldInfo.fieldName;\n            tableParseResult.tableObj = {};\n        }\n        let rowOrColObj: any = tableParseResult.curRowOrColObj;\n        if (isNewRowOrCol) {\n            //新的一行\n            rowOrColObj = {};\n            tableParseResult.curRowOrColObj = tableParseResult.tableObj[transedValue] = rowOrColObj;\n        }\n\n        if (fieldInfo.isMutiColObj) {\n            let subObj = rowOrColObj[fieldInfo.fieldName];\n            if (!subObj) {\n                subObj = {};\n                rowOrColObj[fieldInfo.fieldName] = subObj;\n            }\n            subObj[fieldInfo.subFieldName] = transedValue;\n        } else {\n            rowOrColObj[fieldInfo.fieldName] = transedValue;\n        }\n    }\n    /**\n     * 解析横向单个格子\n     * @param tableParseResult\n     * @param sheet\n     * @param colKey\n     * @param rowIndex\n     * @param isNewRowOrCol 是否为新的一行或者一列\n     */\n    parseHorizontalCell(\n        tableParseResult: ITableParseResult,\n        sheet: xlsx.Sheet,\n        colKey: string,\n        rowIndex: number,\n        isNewRowOrCol: boolean\n    ): void {\n        const fieldInfo = this.getHorizontalTableField(tableParseResult, sheet, colKey, rowIndex);\n        if (!fieldInfo) return;\n        const cell: xlsx.CellObject = sheet[colKey + rowIndex];\n        if (isEmptyCell(cell)) {\n            return;\n        }\n        const transResult = this.transValue(tableParseResult, fieldInfo, cell.v);\n        if (transResult.error) {\n            Logger.log(\n                `!!!!!!!!!!!!!!!!!![-----ParseError|解析错误-----]!!!!!!!!!!!!!!!!!!!!!!!!!\\n` +\n                `[sheetName|分表名]=> ${tableParseResult.curSheetName}\\n` +\n                `[row|行]=> ${rowIndex}\\n` +\n                `[col|列]=> ${colKey}\\n` +\n                `[field|字段]=> ${fieldInfo.originFieldName}\\n` +\n                `[type|类型]=> ${fieldInfo.originType}\\n` +\n                `[error|错误]=> ${typeof transResult.error === \"string\" ? transResult.error : transResult.error.message\n                }\\n` +\n                `!!!!!!!!!!!!!!!!!![-----ParseError|解析错误-----]!!!!!!!!!!!!!!!!!!!!!!!!!\\n`,\n\n                \"error\"\n            );\n        }\n        const transedValue = transResult.value;\n        if (!tableParseResult.tableObj) {\n            tableParseResult.tableObj = {};\n        }\n        if (fieldInfo.isMutiColObj) {\n            let subObj = tableParseResult.tableObj[fieldInfo.fieldName];\n            if (!subObj) {\n                subObj = {};\n                tableParseResult.tableObj[fieldInfo.fieldName] = subObj;\n            }\n            subObj[fieldInfo.subFieldName] = transedValue;\n        } else {\n            tableParseResult.tableObj[fieldInfo.fieldName] = transedValue;\n        }\n    }\n    /**\n     * 解析出字段对象\n     * @param tableParseResult\n     * @param sheet\n     * @param colKey\n     * @param rowIndex\n     */\n    getVerticalTableField(\n        tableParseResult: ITableParseResult,\n        sheet: xlsx.Sheet,\n        colKey: string,\n        rowIndex: number\n    ): ITableField {\n        const tableDefine = tableParseResult.tableDefine;\n        let tableFiledMap = tableParseResult.filedMap;\n        if (!tableFiledMap) {\n            tableFiledMap = {};\n            tableParseResult.filedMap = tableFiledMap;\n        }\n        const verticalFieldDefine = tableDefine.verticalFieldDefine;\n        const filedCell = sheet[colKey + verticalFieldDefine.fieldRow];\n        let originFieldName: string;\n        if (!isEmptyCell(filedCell)) {\n            originFieldName = filedCell.v as string;\n        }\n        if (!originFieldName) return null;\n        let field: ITableField = {} as any;\n        //缓存\n        if (tableFiledMap[originFieldName] !== undefined) {\n            return tableFiledMap[originFieldName];\n        }\n        //注释\n        const textCell: xlsx.CellObject = sheet[colKey + verticalFieldDefine.textRow];\n        if (!isEmptyCell(textCell)) {\n            field.text = textCell.v as string;\n        }\n        //类型\n        let isObjType: boolean = false;\n        const typeCell = sheet[colKey + verticalFieldDefine.typeRow];\n\n        if (isEmptyCell(typeCell)) {\n            return null;\n        } else {\n            field.originType = typeCell.v as string;\n            if (field.originType.includes(\"mf:\")) {\n                const typeStrs = field.originType.split(\":\");\n                if (typeStrs.length < 3) {\n                    return null;\n                }\n                field.type = typeStrs[2];\n                isObjType = true;\n            } else {\n                field.type = field.originType;\n            }\n        }\n        field.isMutiColObj = isObjType;\n        //字段名\n        field.originFieldName = originFieldName;\n        if (isObjType) {\n            const fieldStrs = field.originFieldName.split(\":\");\n            if (fieldStrs.length < 2) {\n                return null;\n            }\n            field.fieldName = fieldStrs[0];\n            field.subFieldName = fieldStrs[1];\n        } else {\n            field.fieldName = field.originFieldName;\n        }\n\n        tableFiledMap[colKey] = field;\n        return field;\n    }\n    getHorizontalTableField(\n        tableParseResult: ITableParseResult,\n        sheet: xlsx.Sheet,\n        colKey: string,\n        rowIndex: number\n    ): ITableField {\n        const tableDefine = tableParseResult.tableDefine;\n        let tableFiledMap = tableParseResult.filedMap;\n        if (!tableFiledMap) {\n            tableFiledMap = {};\n            tableParseResult.filedMap = tableFiledMap;\n        }\n        const hFieldDefine = tableDefine.horizontalFieldDefine;\n        const fieldNameCell: xlsx.CellObject = sheet[hFieldDefine.fieldCol + rowIndex];\n        let originFieldName: string;\n        if (!isEmptyCell(fieldNameCell)) {\n            originFieldName = fieldNameCell.v as string;\n        }\n        if (!originFieldName) return null;\n        if (tableFiledMap[originFieldName] !== undefined) {\n            return tableFiledMap[originFieldName];\n        }\n        let field: ITableField = {} as any;\n\n        const textCell: xlsx.CellObject = sheet[hFieldDefine.textCol + rowIndex];\n        //注释\n        if (!isEmptyCell(textCell)) {\n            field.text = textCell.v as string;\n        }\n        let isObjType: boolean = false;\n        //类型\n        const typeCell: xlsx.CellObject = sheet[hFieldDefine.typeCol + rowIndex];\n\n        if (isEmptyCell(typeCell)) {\n            return null;\n        } else {\n            //处理类型\n            field.originType = typeCell.v as string;\n            if (field.originType.includes(\"mf:\")) {\n                const typeStrs = field.originType.split(\":\");\n                if (typeStrs.length < 3) {\n                    return null;\n                }\n                field.type = typeStrs[2];\n                isObjType = true;\n            } else {\n                field.type = field.originType;\n            }\n        }\n        field.isMutiColObj = isObjType;\n        field.originFieldName = originFieldName;\n        if (isObjType) {\n            const fieldStrs = field.originFieldName.split(\":\");\n            if (fieldStrs.length < 2) {\n                return null;\n            }\n            field.fieldName = fieldStrs[0];\n            field.subFieldName = fieldStrs[1];\n        } else {\n            field.fieldName = field.originFieldName;\n        }\n        tableFiledMap[originFieldName] = field;\n        return field;\n    }\n    /**\n     * 检查列是否需要解析\n     * @param tableDefine\n     * @param sheet\n     * @param colKey\n     */\n    checkColNeedParse(tableDefine: ITableDefine, sheet: xlsx.Sheet, colKey: string): boolean {\n        // 如果类型或者则不需要解析\n        if (tableDefine.tableType === TableType.vertical) {\n            const verticalFieldDefine = tableDefine.verticalFieldDefine;\n            const typeCellObj: xlsx.CellObject = sheet[colKey + verticalFieldDefine.typeRow];\n            const fieldCellObj: xlsx.CellObject = sheet[colKey + verticalFieldDefine.fieldRow];\n            if (isEmptyCell(typeCellObj) || isEmptyCell(fieldCellObj)) {\n                return false;\n            } else {\n                return true;\n            }\n        } else if (tableDefine.tableType === TableType.horizontal) {\n            const cellObj: xlsx.CellObject = sheet[colKey + 1];\n            if (isEmptyCell(cellObj)) {\n                return false;\n            } else {\n                return true;\n            }\n        }\n    }\n    /**\n     * 转换表格的值\n     * @param parseResult\n     * @param filedItem\n     * @param cellValue\n     */\n    public transValue(parseResult: ITableParseResult, filedItem: ITableField, cellValue: any): ITransValueResult {\n        let transResult: ITransValueResult;\n\n        let transFunc = this._valueTransFuncMap[filedItem.type];\n        if (!transFunc) {\n            transFunc = this._valueTransFuncMap[\"json\"];\n        }\n        transResult = transFunc(filedItem, cellValue);\n        return transResult;\n    }\n\n    /**\n     * 解析配置表文件\n     * @param parseConfig 解析配置\n     * @param fileInfo 文件信息\n     * @param parseResult 解析结果\n     */\n    public parseTableFile(\n        parseConfig: ITableConvertConfig,\n        fileInfo: IFileInfo,\n        parseResult: ITableParseResult\n    ): ITableParseResult {\n\n        const workbook = fileInfo.fileData ? readTableData(fileInfo) : readTableFile(fileInfo);\n        if (!workbook.SheetNames.length) return;\n\n        const sheetNames = workbook.SheetNames;\n        const tableDefine: ITableDefine = this.getTableDefine(fileInfo, workbook);\n        for (let i = 0; i < sheetNames.length; i++) { }\n        if (!tableDefine) return null;\n        let sheetName: string;\n        let sheet: xlsx.Sheet;\n        const isSheetRowEnd = this.isSheetRowEnd.bind(null, tableDefine);\n        const isSheetColEnd = this.isSheetColEnd.bind(null, tableDefine);\n        const isSkipSheetRow = (sheet: xlsx.Sheet, rowIndex: number) => {\n            return !this.checkRowNeedParse(tableDefine, sheet, rowIndex);\n        };\n        const isSkipSheetCol = (sheet: xlsx.Sheet, colKey: string) => {\n            return !this.checkColNeedParse(tableDefine, sheet, colKey);\n        };\n        let cellObj: xlsx.CellObject;\n        parseResult.tableDefine = tableDefine;\n        Logger.log(`[parseTable|解析文件]=> ${fileInfo.filePath}`);\n        for (let i = 0; i < sheetNames.length; i++) {\n            sheetName = sheetNames[i];\n            sheet = workbook.Sheets[sheetName];\n            if (!this.checkSheetCanParse(tableDefine, sheet, sheetName)) {\n                continue;\n            }\n            parseResult.curSheetName = sheetName;\n            Logger.log(`|=[parseSheet|解析分表]=> ${sheetName}`);\n            if (tableDefine.tableType === TableType.vertical) {\n                let lastRowIndex: number;\n\n                verticalForEachSheet(\n                    sheet,\n                    tableDefine.startRow,\n                    tableDefine.startCol,\n                    (sheet, colKey: string, rowIndex: number) => {\n                        let isNewRowOrCol = false;\n                        if (lastRowIndex !== rowIndex) {\n                            lastRowIndex = rowIndex;\n                            isNewRowOrCol = true;\n                        }\n                        cellObj = sheet[colKey + rowIndex];\n                        if (!isEmptyCell(cellObj)) {\n                            this.parseVerticalCell(parseResult, sheet, colKey, rowIndex, isNewRowOrCol);\n                        }\n                    },\n                    isSheetRowEnd,\n                    isSheetColEnd,\n                    isSkipSheetRow,\n                    isSkipSheetCol\n                );\n            } else if (tableDefine.tableType === TableType.horizontal) {\n                let lastColKey: string;\n\n                horizontalForEachSheet(\n                    sheet,\n                    tableDefine.startRow,\n                    tableDefine.startCol,\n                    (sheet, colKey: string, rowIndex: number) => {\n                        let isNewRowOrCol = false;\n                        if (lastColKey !== colKey) {\n                            lastColKey = colKey;\n                            isNewRowOrCol = true;\n                        }\n\n                        cellObj = sheet[colKey + rowIndex];\n                        if (!isEmptyCell(cellObj)) {\n                            this.parseHorizontalCell(parseResult, sheet, colKey, rowIndex, isNewRowOrCol);\n                        }\n                    },\n                    isSheetRowEnd,\n                    isSheetColEnd,\n                    isSkipSheetRow,\n                    isSkipSheetCol\n                );\n            }\n        }\n\n        return parseResult as any;\n    }\n}\n","import { DefaultOutPutTransformer } from \"./default-output-transformer\";\nimport { Logger } from \"./loger\";\n\nexport class DefaultConvertHook implements IConvertHook {\n    onStart?(context: IConvertContext, cb: VoidFunction): void {\n        Logger.systemLog(`[excel2all] convert-hook onStart`);\n        Logger.systemLog(`[excel2all] 开始表转换`);\n        cb();\n    }\n    onParseBefore?(context: IConvertContext, cb: VoidFunction): void {\n        Logger.systemLog(`convert-hook onParseBefore`);\n        cb();\n    }\n    onParseAfter?(context: IConvertContext, cb: VoidFunction): void {\n        let transformer: IOutPutTransformer = context.outputTransformer;\n\n        transformer.transform(context, cb);\n    }\n    onWriteFileEnd(context: IConvertContext): void {\n        Logger.systemLog(`convert-hook onWriteFileEnd 写入结束`);\n    }\n}\n","import * as path from \"path\";\nimport { TableType } from \"./default-parse-handler\";\nimport { deflateSync } from \"zlib\";\nimport { osEol } from \"./get-os-eol\";\nimport { Logger } from \"./loger\";\ndeclare global {\n    /**\n     * 输出配置\n     */\n    interface IOutputConfig {\n        /**单个配置表json输出目录路径 */\n        clientSingleTableJsonDir?: string;\n        /**合并配置表json文件路径(包含文件名,比如 ./out/bundle.json) */\n        clientBundleJsonOutPath?: string;\n        /**是否格式化合并后的json，默认不 */\n        isFormatBundleJson?: boolean;\n        /**是否生成声明文件，默认不输出 */\n        isGenDts?: boolean;\n        /**声明文件输出目录(每个配置表一个声明)，默认不输出 */\n        clientDtsOutDir?: string;\n        /**是否合并所有声明为一个文件,默认true */\n        isBundleDts?: boolean;\n        /**合并后的声明文件名,如果没有则默认为tableMap */\n        bundleDtsFileName?: string;\n        /**是否将json格式压缩,默认否,减少json字段名字符,效果较小 */\n        isCompress?: boolean;\n        /**是否Zip压缩,使用zlib */\n        isZip?: boolean;\n    }\n}\n\n/**类型字符串映射字典 */\nconst typeStrMap = { int: \"number\", json: \"any\", \"[int]\": \"number[]\", \"[string]\": \"string[]\" };\nexport class DefaultOutPutTransformer {\n    /**\n     * 转换\n     * @param context\n     * @returns\n     */\n    transform(context: IConvertContext, cb: VoidFunction) {\n        const convertConfig = context.convertConfig;\n        const parseResultMap = context.parseResultMap;\n        let outputConfig: IOutputConfig = convertConfig.outputConfig;\n        if (!outputConfig) {\n            console.error(`parseConfig.outputConfig is undefind`);\n            return;\n        }\n\n        let tableObjMap: { [key: string]: any } = {};\n        let outputFileMap: OutPutFileMap = {};\n        let tableTypeMapDtsStr = \"\";\n        let tableTypeDtsStrs = \"\";\n        let parseResult: ITableParseResult;\n        let tableName: string;\n        let tableObj: any;\n        let objTypeTableMap: { [key: string]: boolean } = {};\n        Logger.log(`[outputTransform |转换解析结果]请稍等...`);\n        for (let filePath in parseResultMap) {\n            parseResult = parseResultMap[filePath];\n            if (!parseResult.tableDefine) continue;\n\n            tableName = parseResult.tableDefine.tableName;\n\n            //合并多个同名表\n            tableObj = tableObjMap[tableName];\n            if (tableObj) {\n                tableObj = Object.assign(tableObj, parseResult.tableObj);\n            } else {\n                tableObj = parseResult.tableObj;\n            }\n            tableObjMap[tableName] = tableObj;\n\n            if (outputConfig.isGenDts && objTypeTableMap[tableName] === undefined) {\n                objTypeTableMap[tableName] = parseResult.tableDefine.tableType === TableType.horizontal;\n                if (parseResult.tableDefine.tableType === TableType.horizontal) {\n                    tableTypeMapDtsStr += \"\\treadonly \" + tableName + \"?: \" + `IT_${tableName};` + osEol;\n                } else {\n                    tableTypeMapDtsStr += this._getOneTableTypeStr(tableName);\n                }\n                //输出单个文件\n                if (outputConfig.isBundleDts === undefined) outputConfig.isBundleDts = true;\n                if (!outputConfig.isBundleDts) {\n                    this._addSingleTableDtsOutputFile(outputConfig, parseResult, outputFileMap);\n                } else {\n                    tableTypeDtsStrs += this._getSingleTableDts(parseResult);\n                }\n            }\n\n            //生成单个表json\n            if (outputConfig.clientSingleTableJsonDir) {\n                this._addSingleTableJsonOutputFile(outputConfig, parseResult, outputFileMap);\n            }\n        }\n        if (outputConfig.isGenDts) {\n            //输出声明文件\n            let itBaseStr = \"interface ITBase<T> { [key:string]:T}\" + osEol;\n\n            tableTypeMapDtsStr = itBaseStr + \"interface IT_TableMap {\" + osEol + tableTypeMapDtsStr + \"}\" + osEol;\n\n            if (outputConfig.isBundleDts) {\n                //合成一个文件\n                const dtsFileName = outputConfig.bundleDtsFileName ? outputConfig.bundleDtsFileName : \"tableMap\";\n                const bundleDtsFilePath = path.join(outputConfig.clientDtsOutDir, `${dtsFileName}.d.ts`);\n                outputFileMap[bundleDtsFilePath] = {\n                    filePath: bundleDtsFilePath,\n                    data: tableTypeMapDtsStr + tableTypeDtsStrs\n                };\n            } else {\n                //拆分文件输出\n                const tableTypeMapDtsFilePath = path.join(outputConfig.clientDtsOutDir, \"tableMap.d.ts\");\n                outputFileMap[tableTypeMapDtsFilePath] = {\n                    filePath: tableTypeMapDtsFilePath,\n                    data: tableTypeMapDtsStr\n                };\n            }\n        }\n\n        //jsonBundleFile\n        if (outputConfig.clientBundleJsonOutPath) {\n            let jsonBundleFilePath = outputConfig.clientBundleJsonOutPath;\n            let outputData: any;\n            if (outputConfig.isCompress) {\n                //进行格式压缩\n                const newTableObjMap = {};\n                let tableObj: any;\n                let newTableObj: any;\n                for (let tableName in tableObjMap) {\n                    if (objTypeTableMap[tableName]) {\n                        newTableObjMap[tableName] = tableObjMap[tableName];\n                        continue;\n                    }\n                    tableObj = tableObjMap[tableName];\n                    newTableObj = { fieldValuesMap: {} };\n                    for (let mainKey in tableObj) {\n                        if (!newTableObj.fieldNames) {\n                            newTableObj.fieldNames = Object.keys(tableObj[mainKey]);\n                        }\n                        newTableObj.fieldValuesMap[mainKey] = Object.values(tableObj[mainKey]);\n                    }\n                    newTableObjMap[tableName] = newTableObj;\n                }\n                outputData = JSON.stringify(newTableObjMap);\n            } else {\n                outputData = JSON.stringify(tableObjMap);\n            }\n            //进行base64处理\n            // if (outputConfig.bundleJsonIsEncode2Base64) {\n            //     outputData = Base64.encode(outputData);\n            //     if (outputConfig.preBase64UglyString) {\n            //         outputData = outputConfig.preBase64UglyString + outputData;\n            //     }\n            //     if (outputConfig.sufBase64UglyString) {\n            //         outputData += outputConfig.sufBase64UglyString;\n            //     }\n            // }\n            if (outputConfig.isZip) {\n                //使用zilb压缩\n                outputData = deflateSync(outputData);\n            }\n            outputFileMap[jsonBundleFilePath] = {\n                filePath: jsonBundleFilePath,\n                encoding: typeof outputData !== \"string\" ? \"binary\" : \"utf-8\",\n                data: outputData\n            };\n        }\n        if (context.outPutFileMap) {\n            for (let key in outputFileMap) {\n                context.outPutFileMap[key] = outputFileMap[key];\n            }\n        } else {\n            context.outPutFileMap = outputFileMap;\n        }\n        cb();\n    }\n    private _addSingleTableDtsOutputFile(\n        config: IOutputConfig,\n        parseResult: ITableParseResult,\n        outputFileMap: OutPutFileMap\n    ): void {\n        //如果值没有就不输出类型信息了\n        if (!parseResult.tableObj) return;\n        let dtsFilePath: string = path.join(config.clientDtsOutDir, `${parseResult.tableDefine.tableName}.d.ts`);\n\n        if (!outputFileMap[dtsFilePath]) {\n            //\n            const dtsStr = this._getSingleTableDts(parseResult);\n            if (dtsStr) {\n                outputFileMap[dtsFilePath] = { filePath: dtsFilePath, data: dtsStr } as any;\n            }\n        }\n    }\n    /**\n     * 解析出单个配置表类型数据\n     * @param parseResult\n     */\n    private _getSingleTableDts(parseResult: ITableParseResult): string {\n        const tableName = parseResult.tableDefine.tableName;\n\n        const colKeyTableFieldMap: ColKeyTableFieldMap = parseResult.filedMap;\n        let itemInterface = \"interface IT_\" + tableName + \" {\" + osEol;\n        let tableField: ITableField;\n        let typeStr: string;\n        let objTypeStrMap: { [key: string]: string } = {};\n\n        for (let colKey in colKeyTableFieldMap) {\n            tableField = colKeyTableFieldMap[colKey];\n            if (!tableField) continue;\n            if (!tableField.isMutiColObj) {\n                //注释行\n                itemInterface += \"\\t/** \" + tableField.text + \" */\" + osEol;\n                //字段类型声明行\n                itemInterface +=\n                    \"\\treadonly \" +\n                    tableField.fieldName +\n                    \"?: \" +\n                    (typeStrMap[tableField.type] ? typeStrMap[tableField.type] : tableField.type) +\n                    \";\" +\n                    osEol;\n            } else {\n                const objFieldKey = tableField.fieldName;\n                if (!objTypeStrMap[objFieldKey]) {\n                    objTypeStrMap[objFieldKey] = \"\";\n                }\n\n                //注释行\n                objTypeStrMap[objFieldKey] += \"\\t\\t/** \" + tableField.text + \" */\" + osEol;\n\n                //字段类型声明行\n                objTypeStrMap[objFieldKey] +=\n                    \"\\t\\treadonly \" +\n                    tableField.subFieldName +\n                    \"?: \" +\n                    (typeStrMap[tableField.type] ? typeStrMap[tableField.type] : tableField.type) +\n                    \";\" +\n                    osEol;\n            }\n        }\n        //第二层对象\n        for (let objFieldKey in objTypeStrMap) {\n            //字段类型声明行\n            itemInterface += \"\\treadonly \" + objFieldKey + \"?: {\" + osEol + objTypeStrMap[objFieldKey];\n            itemInterface += \"\\t}\" + osEol;\n        }\n        itemInterface += \"}\" + osEol;\n\n        return itemInterface;\n    }\n    /**\n     * 添加单独导出配置表json文件\n     * @param config\n     * @param parseResult\n     * @param outputFileMap\n     */\n    private _addSingleTableJsonOutputFile(\n        config: IOutputConfig,\n        parseResult: ITableParseResult,\n        outputFileMap: OutPutFileMap\n    ) {\n        const tableObj = parseResult.tableObj;\n        if (!tableObj) return;\n        const tableName = parseResult.tableDefine.tableName;\n        let singleJsonFilePath = path.join(config.clientSingleTableJsonDir, `${tableName}.json`);\n        let singleJsonData = JSON.stringify(tableObj, null, \"\\t\");\n\n        let singleOutputFileInfo = outputFileMap[singleJsonFilePath];\n        if (singleOutputFileInfo) {\n            singleOutputFileInfo.data = singleJsonData;\n        } else {\n            singleOutputFileInfo = {\n                filePath: singleJsonFilePath,\n                data: singleJsonData\n            };\n            outputFileMap[singleJsonFilePath] = singleOutputFileInfo;\n        }\n    }\n    private _getOneTableTypeStr(tableName: string): string {\n        return \"\\treadonly \" + tableName + \"?: \" + \"ITBase<\" + \"IT_\" + tableName + \">;\" + osEol;\n    }\n}\n","export function doParse(\n    parseConfig: ITableConvertConfig,\n    fileInfos: IFileInfo[],\n    parseResultMap: TableParseResultMap,\n    parseHandler: ITableParseHandler\n) {\n    let parseResult;\n    for (let i = fileInfos.length - 1; i >= 0; i--) {\n        parseResult = parseResultMap[fileInfos[i].filePath];\n        if (!parseResult) {\n            parseResult = { filePath: fileInfos[i].filePath };\n        }\n        if (!parseResult.tableObj) {\n            parseResult = parseHandler.parseTableFile(parseConfig, fileInfos[i], parseResult);\n        }\n        if (parseResult) {\n            parseResultMap[fileInfos[i].filePath] = parseResult;\n        }\n    }\n}\n","import * as fs from \"fs-extra\";\nimport * as path from \"path\";\nimport * as crypto from \"crypto\";\nimport { Logger } from \"./loger\";\nimport { BinaryLike } from \"node:crypto\";\n\ndeclare global {\n    interface IOutPutFileInfo {\n        filePath: string;\n        /**写入编码，字符串默认utf8 */\n        encoding?: BufferEncoding;\n        /**是否删除 */\n        isDelete?: boolean;\n        data?: any;\n    }\n}\n/**\n * 遍历文件\n * @param dirPath 文件夹路径\n * @param eachCallback 遍历回调 (filePath: string) => void\n */\nexport function forEachFile(fileOrDirPath: string, eachCallback?: (filePath: string) => void) {\n\n    if (fs.statSync(fileOrDirPath).isDirectory() && (fileOrDirPath !== \".git\" && fileOrDirPath !== \".svn\")) {\n        const fileNames = fs.readdirSync(fileOrDirPath);\n        let childFilePath: string;\n        for (var i = 0; i < fileNames.length; i++) {\n            childFilePath = path.join(fileOrDirPath, fileNames[i]);\n            forEachFile(childFilePath, eachCallback);\n        }\n    } else {\n        eachCallback(fileOrDirPath);\n    }\n}\n/**\n * 批量写入和删除文件\n * @param outputFileInfos 需要写入的文件信息数组\n * @param onProgress 进度变化回调\n * @param complete 完成回调\n */\nexport function writeOrDeleteOutPutFiles(\n    outputFileInfos: IOutPutFileInfo[],\n    onProgress?: (filePath: string, total: number, now: number, isOk: boolean) => void,\n    complete?: (total: number) => void\n) {\n    let fileInfo: IOutPutFileInfo;\n    const total = outputFileInfos.length;\n    if (outputFileInfos && total) {\n        let now = 0;\n        const onWriteEnd = (err) => {\n            if (err) {\n                Logger.log(err, \"error\");\n            }\n            now++;\n            onProgress && onProgress(outputFileInfos[now - 1].filePath, total, now, !err);\n            if (now >= total) {\n                complete && complete(total);\n            }\n        };\n        for (let i = outputFileInfos.length - 1; i >= 0; i--) {\n            fileInfo = outputFileInfos[i];\n\n            if (fileInfo.isDelete && fs.existsSync(fileInfo.filePath)) {\n                fs.unlinkSync(fileInfo.filePath);\n            } else {\n                if (fs.existsSync(fileInfo.filePath) && fs.statSync(fileInfo.filePath).isDirectory()) {\n                    Logger.log(`路径为文件夹:${fileInfo.filePath}`, \"error\");\n                    continue;\n                }\n\n                if (!fileInfo.encoding && typeof fileInfo.data === \"string\") {\n                    fileInfo.encoding = \"utf8\";\n                }\n                fs.ensureFileSync(fileInfo.filePath);\n                fs.writeFile(\n                    fileInfo.filePath,\n                    fileInfo.data,\n                    fileInfo.encoding ? { encoding: fileInfo.encoding } : undefined,\n                    onWriteEnd\n                );\n            }\n        }\n    }\n}\n/**\n * 获取变化过的文件数组\n * @param dir 目标目录\n * @param cacheFilePath 缓存文件绝对路径\n * @param eachCallback 遍历回调\n * @returns 返回缓存文件路径\n */\nexport function forEachChangedFile(\n    dir: string,\n    cacheFilePath?: string,\n    eachCallback?: (filePath: string, isDelete?: boolean) => void\n) {\n    const gcfCache = getCacheData(cacheFilePath);\n    const oldFilePaths = Object.keys(gcfCache);\n    let oldFilePathIndex: number;\n    forEachFile(dir, (filePath) => {\n        var md5str = getFileMd5Sync(filePath);\n        if (!gcfCache[filePath] || (gcfCache[filePath] && gcfCache[filePath] !== md5str)) {\n            gcfCache[filePath] = md5str;\n            eachCallback(filePath, false);\n        }\n        oldFilePathIndex = oldFilePaths.indexOf(filePath);\n        if (oldFilePathIndex > -1) {\n            const endFilePath = oldFilePaths[oldFilePaths.length - 1];\n            oldFilePaths[oldFilePathIndex] = endFilePath;\n            oldFilePaths.pop();\n        }\n    });\n    for (let i = 0; i < oldFilePaths.length; i++) {\n        delete gcfCache[oldFilePaths[i]];\n        eachCallback(oldFilePaths[i], true);\n    }\n    fs.writeFileSync(cacheFilePath, JSON.stringify(gcfCache), { encoding: \"utf-8\" });\n}\n/**\n * 写入缓存数据\n * @param cacheFilePath\n * @param cacheData\n */\nexport function writeCacheData(cacheFilePath: string, cacheData: any) {\n    if (!cacheFilePath) {\n        Logger.log(`cacheFilePath is null`, \"error\");\n        return;\n    }\n    fs.writeFileSync(cacheFilePath, JSON.stringify(cacheData), { encoding: \"utf-8\" });\n}\n/**\n * 读取缓存数据\n * @param cacheFilePath\n */\nexport function getCacheData(cacheFilePath: string): any {\n    if (!cacheFilePath) {\n        Logger.log(`cacheFilePath is null`, \"error\");\n        return;\n    }\n    if (!fs.existsSync(cacheFilePath)) {\n        fs.ensureFileSync(cacheFilePath);\n        fs.writeFileSync(cacheFilePath, \"{}\", { encoding: \"utf-8\" });\n    }\n    const gcfCacheFile = fs.readFileSync(cacheFilePath, \"utf-8\");\n    const gcfCache = JSON.parse(gcfCacheFile);\n    return gcfCache;\n}\n/**\n * 获取文件md5 (同步)\n * @param filePath\n */\nexport function getFileMd5Sync(filePath: string, encoding?: BufferEncoding): string {\n    const file = fs.readFileSync(filePath, encoding);\n    var md5um = crypto.createHash(\"md5\");\n    md5um.update(file);\n    return md5um.digest(\"hex\");\n}\n/**\n * 获取文件md5 (异步)\n * @param filePath\n */\nexport function getFileMd5Async(filePath: string, cb: (md5Str: string) => void, encoding?: BufferEncoding) {\n    fs.readFile(filePath, encoding, (err, file) => {\n        var md5um = crypto.createHash(\"md5\");\n        md5um.update(file);\n        const md5Str = md5um.digest(\"hex\");\n        cb(md5Str);\n    });\n}\n/**\n * 获取文件md5\n * @param file 文件对象\n * @returns\n */\nexport function getFileMd5(file: BinaryLike) {\n    const md5um = crypto.createHash(\"md5\");\n    md5um.update(file);\n    return md5um.digest(\"hex\");\n}\n/**\n * 获取文件 md5\n * @param filePath\n */\nexport async function getFileMd5ByPath(filePath: string) {\n    return getFileMd5Sync(filePath);\n}\n","'use strict';\n\nexports.isInteger = num => {\n  if (typeof num === 'number') {\n    return Number.isInteger(num);\n  }\n  if (typeof num === 'string' && num.trim() !== '') {\n    return Number.isInteger(Number(num));\n  }\n  return false;\n};\n\n/**\n * Find a node of the given type\n */\n\nexports.find = (node, type) => node.nodes.find(node => node.type === type);\n\n/**\n * Find a node of the given type\n */\n\nexports.exceedsLimit = (min, max, step = 1, limit) => {\n  if (limit === false) return false;\n  if (!exports.isInteger(min) || !exports.isInteger(max)) return false;\n  return ((Number(max) - Number(min)) / Number(step)) >= limit;\n};\n\n/**\n * Escape the given node with '\\\\' before node.value\n */\n\nexports.escapeNode = (block, n = 0, type) => {\n  let node = block.nodes[n];\n  if (!node) return;\n\n  if ((type && node.type === type) || node.type === 'open' || node.type === 'close') {\n    if (node.escaped !== true) {\n      node.value = '\\\\' + node.value;\n      node.escaped = true;\n    }\n  }\n};\n\n/**\n * Returns true if the given brace node should be enclosed in literal braces\n */\n\nexports.encloseBrace = node => {\n  if (node.type !== 'brace') return false;\n  if ((node.commas >> 0 + node.ranges >> 0) === 0) {\n    node.invalid = true;\n    return true;\n  }\n  return false;\n};\n\n/**\n * Returns true if a brace node is invalid.\n */\n\nexports.isInvalidBrace = block => {\n  if (block.type !== 'brace') return false;\n  if (block.invalid === true || block.dollar) return true;\n  if ((block.commas >> 0 + block.ranges >> 0) === 0) {\n    block.invalid = true;\n    return true;\n  }\n  if (block.open !== true || block.close !== true) {\n    block.invalid = true;\n    return true;\n  }\n  return false;\n};\n\n/**\n * Returns true if a node is an open or close node\n */\n\nexports.isOpenOrClose = node => {\n  if (node.type === 'open' || node.type === 'close') {\n    return true;\n  }\n  return node.open === true || node.close === true;\n};\n\n/**\n * Reduce an array of text nodes.\n */\n\nexports.reduce = nodes => nodes.reduce((acc, node) => {\n  if (node.type === 'text') acc.push(node.value);\n  if (node.type === 'range') node.type = 'text';\n  return acc;\n}, []);\n\n/**\n * Flatten an array\n */\n\nexports.flatten = (...args) => {\n  const result = [];\n  const flat = arr => {\n    for (let i = 0; i < arr.length; i++) {\n      let ele = arr[i];\n      Array.isArray(ele) ? flat(ele, result) : ele !== void 0 && result.push(ele);\n    }\n    return result;\n  };\n  flat(args);\n  return result;\n};\n","'use strict';\n\nconst path = require('path');\nconst WIN_SLASH = '\\\\\\\\/';\nconst WIN_NO_SLASH = `[^${WIN_SLASH}]`;\n\n/**\n * Posix glob regex\n */\n\nconst DOT_LITERAL = '\\\\.';\nconst PLUS_LITERAL = '\\\\+';\nconst QMARK_LITERAL = '\\\\?';\nconst SLASH_LITERAL = '\\\\/';\nconst ONE_CHAR = '(?=.)';\nconst QMARK = '[^/]';\nconst END_ANCHOR = `(?:${SLASH_LITERAL}|$)`;\nconst START_ANCHOR = `(?:^|${SLASH_LITERAL})`;\nconst DOTS_SLASH = `${DOT_LITERAL}{1,2}${END_ANCHOR}`;\nconst NO_DOT = `(?!${DOT_LITERAL})`;\nconst NO_DOTS = `(?!${START_ANCHOR}${DOTS_SLASH})`;\nconst NO_DOT_SLASH = `(?!${DOT_LITERAL}{0,1}${END_ANCHOR})`;\nconst NO_DOTS_SLASH = `(?!${DOTS_SLASH})`;\nconst QMARK_NO_DOT = `[^.${SLASH_LITERAL}]`;\nconst STAR = `${QMARK}*?`;\n\nconst POSIX_CHARS = {\n  DOT_LITERAL,\n  PLUS_LITERAL,\n  QMARK_LITERAL,\n  SLASH_LITERAL,\n  ONE_CHAR,\n  QMARK,\n  END_ANCHOR,\n  DOTS_SLASH,\n  NO_DOT,\n  NO_DOTS,\n  NO_DOT_SLASH,\n  NO_DOTS_SLASH,\n  QMARK_NO_DOT,\n  STAR,\n  START_ANCHOR\n};\n\n/**\n * Windows glob regex\n */\n\nconst WINDOWS_CHARS = {\n  ...POSIX_CHARS,\n\n  SLASH_LITERAL: `[${WIN_SLASH}]`,\n  QMARK: WIN_NO_SLASH,\n  STAR: `${WIN_NO_SLASH}*?`,\n  DOTS_SLASH: `${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$)`,\n  NO_DOT: `(?!${DOT_LITERAL})`,\n  NO_DOTS: `(?!(?:^|[${WIN_SLASH}])${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$))`,\n  NO_DOT_SLASH: `(?!${DOT_LITERAL}{0,1}(?:[${WIN_SLASH}]|$))`,\n  NO_DOTS_SLASH: `(?!${DOT_LITERAL}{1,2}(?:[${WIN_SLASH}]|$))`,\n  QMARK_NO_DOT: `[^.${WIN_SLASH}]`,\n  START_ANCHOR: `(?:^|[${WIN_SLASH}])`,\n  END_ANCHOR: `(?:[${WIN_SLASH}]|$)`\n};\n\n/**\n * POSIX Bracket Regex\n */\n\nconst POSIX_REGEX_SOURCE = {\n  alnum: 'a-zA-Z0-9',\n  alpha: 'a-zA-Z',\n  ascii: '\\\\x00-\\\\x7F',\n  blank: ' \\\\t',\n  cntrl: '\\\\x00-\\\\x1F\\\\x7F',\n  digit: '0-9',\n  graph: '\\\\x21-\\\\x7E',\n  lower: 'a-z',\n  print: '\\\\x20-\\\\x7E ',\n  punct: '\\\\-!\"#$%&\\'()\\\\*+,./:;<=>?@[\\\\]^_`{|}~',\n  space: ' \\\\t\\\\r\\\\n\\\\v\\\\f',\n  upper: 'A-Z',\n  word: 'A-Za-z0-9_',\n  xdigit: 'A-Fa-f0-9'\n};\n\nmodule.exports = {\n  MAX_LENGTH: 1024 * 64,\n  POSIX_REGEX_SOURCE,\n\n  // regular expressions\n  REGEX_BACKSLASH: /\\\\(?![*+?^${}(|)[\\]])/g,\n  REGEX_NON_SPECIAL_CHARS: /^[^@![\\].,$*+?^{}()|\\\\/]+/,\n  REGEX_SPECIAL_CHARS: /[-*+?.^${}(|)[\\]]/,\n  REGEX_SPECIAL_CHARS_BACKREF: /(\\\\?)((\\W)(\\3*))/g,\n  REGEX_SPECIAL_CHARS_GLOBAL: /([-*+?.^${}(|)[\\]])/g,\n  REGEX_REMOVE_BACKSLASH: /(?:\\[.*?[^\\\\]\\]|\\\\(?=.))/g,\n\n  // Replace globs with equivalent patterns to reduce parsing time.\n  REPLACEMENTS: {\n    '***': '*',\n    '**/**': '**',\n    '**/**/**': '**'\n  },\n\n  // Digits\n  CHAR_0: 48, /* 0 */\n  CHAR_9: 57, /* 9 */\n\n  // Alphabet chars.\n  CHAR_UPPERCASE_A: 65, /* A */\n  CHAR_LOWERCASE_A: 97, /* a */\n  CHAR_UPPERCASE_Z: 90, /* Z */\n  CHAR_LOWERCASE_Z: 122, /* z */\n\n  CHAR_LEFT_PARENTHESES: 40, /* ( */\n  CHAR_RIGHT_PARENTHESES: 41, /* ) */\n\n  CHAR_ASTERISK: 42, /* * */\n\n  // Non-alphabetic chars.\n  CHAR_AMPERSAND: 38, /* & */\n  CHAR_AT: 64, /* @ */\n  CHAR_BACKWARD_SLASH: 92, /* \\ */\n  CHAR_CARRIAGE_RETURN: 13, /* \\r */\n  CHAR_CIRCUMFLEX_ACCENT: 94, /* ^ */\n  CHAR_COLON: 58, /* : */\n  CHAR_COMMA: 44, /* , */\n  CHAR_DOT: 46, /* . */\n  CHAR_DOUBLE_QUOTE: 34, /* \" */\n  CHAR_EQUAL: 61, /* = */\n  CHAR_EXCLAMATION_MARK: 33, /* ! */\n  CHAR_FORM_FEED: 12, /* \\f */\n  CHAR_FORWARD_SLASH: 47, /* / */\n  CHAR_GRAVE_ACCENT: 96, /* ` */\n  CHAR_HASH: 35, /* # */\n  CHAR_HYPHEN_MINUS: 45, /* - */\n  CHAR_LEFT_ANGLE_BRACKET: 60, /* < */\n  CHAR_LEFT_CURLY_BRACE: 123, /* { */\n  CHAR_LEFT_SQUARE_BRACKET: 91, /* [ */\n  CHAR_LINE_FEED: 10, /* \\n */\n  CHAR_NO_BREAK_SPACE: 160, /* \\u00A0 */\n  CHAR_PERCENT: 37, /* % */\n  CHAR_PLUS: 43, /* + */\n  CHAR_QUESTION_MARK: 63, /* ? */\n  CHAR_RIGHT_ANGLE_BRACKET: 62, /* > */\n  CHAR_RIGHT_CURLY_BRACE: 125, /* } */\n  CHAR_RIGHT_SQUARE_BRACKET: 93, /* ] */\n  CHAR_SEMICOLON: 59, /* ; */\n  CHAR_SINGLE_QUOTE: 39, /* ' */\n  CHAR_SPACE: 32, /*   */\n  CHAR_TAB: 9, /* \\t */\n  CHAR_UNDERSCORE: 95, /* _ */\n  CHAR_VERTICAL_LINE: 124, /* | */\n  CHAR_ZERO_WIDTH_NOBREAK_SPACE: 65279, /* \\uFEFF */\n\n  SEP: path.sep,\n\n  /**\n   * Create EXTGLOB_CHARS\n   */\n\n  extglobChars(chars) {\n    return {\n      '!': { type: 'negate', open: '(?:(?!(?:', close: `))${chars.STAR})` },\n      '?': { type: 'qmark', open: '(?:', close: ')?' },\n      '+': { type: 'plus', open: '(?:', close: ')+' },\n      '*': { type: 'star', open: '(?:', close: ')*' },\n      '@': { type: 'at', open: '(?:', close: ')' }\n    };\n  },\n\n  /**\n   * Create GLOB_CHARS\n   */\n\n  globChars(win32) {\n    return win32 === true ? WINDOWS_CHARS : POSIX_CHARS;\n  }\n};\n","'use strict';\n\nconst path = require('path');\nconst win32 = process.platform === 'win32';\nconst {\n  REGEX_BACKSLASH,\n  REGEX_REMOVE_BACKSLASH,\n  REGEX_SPECIAL_CHARS,\n  REGEX_SPECIAL_CHARS_GLOBAL\n} = require('./constants');\n\nexports.isObject = val => val !== null && typeof val === 'object' && !Array.isArray(val);\nexports.hasRegexChars = str => REGEX_SPECIAL_CHARS.test(str);\nexports.isRegexChar = str => str.length === 1 && exports.hasRegexChars(str);\nexports.escapeRegex = str => str.replace(REGEX_SPECIAL_CHARS_GLOBAL, '\\\\$1');\nexports.toPosixSlashes = str => str.replace(REGEX_BACKSLASH, '/');\n\nexports.removeBackslashes = str => {\n  return str.replace(REGEX_REMOVE_BACKSLASH, match => {\n    return match === '\\\\' ? '' : match;\n  });\n};\n\nexports.supportsLookbehinds = () => {\n  const segs = process.version.slice(1).split('.').map(Number);\n  if (segs.length === 3 && segs[0] >= 9 || (segs[0] === 8 && segs[1] >= 10)) {\n    return true;\n  }\n  return false;\n};\n\nexports.isWindows = options => {\n  if (options && typeof options.windows === 'boolean') {\n    return options.windows;\n  }\n  return win32 === true || path.sep === '\\\\';\n};\n\nexports.escapeLast = (input, char, lastIdx) => {\n  const idx = input.lastIndexOf(char, lastIdx);\n  if (idx === -1) return input;\n  if (input[idx - 1] === '\\\\') return exports.escapeLast(input, char, idx - 1);\n  return `${input.slice(0, idx)}\\\\${input.slice(idx)}`;\n};\n\nexports.removePrefix = (input, state = {}) => {\n  let output = input;\n  if (output.startsWith('./')) {\n    output = output.slice(2);\n    state.prefix = './';\n  }\n  return output;\n};\n\nexports.wrapOutput = (input, state = {}, options = {}) => {\n  const prepend = options.contains ? '' : '^';\n  const append = options.contains ? '' : '$';\n\n  let output = `${prepend}(?:${input})${append}`;\n  if (state.negated === true) {\n    output = `(?:^(?!${output}).*$)`;\n  }\n  return output;\n};\n","import * as path from \"path\";\nimport * as fs from \"fs-extra\";\nimport * as mmatch from \"micromatch\";\nimport { forEachFile, getCacheData, getFileMd5, getFileMd5Sync, writeCacheData, writeOrDeleteOutPutFiles } from \"./file-utils\";\nimport { doParse } from \"./do-parse\";\nimport { DefaultParseHandler } from \"./default-parse-handler\";\nimport { Logger } from \"./loger\";\nimport { DefaultConvertHook } from \"./default-convert-hook\";\nimport { DefaultOutPutTransformer } from \"./default-output-transformer\";\nimport { isCSV } from './table-utils';\nimport fg from \"fast-glob\"\n\nconst defaultDir = \".excel2all\";\nconst cacheFileName = \".e2aprmc\";\nconst logFileName = \"excel2all.log\";\nlet startTime = 0;\nconst defaultPattern = [\"./**/*.xlsx\", \"./**/*.csv\", \"!**/~$*.*\", \"!**/~.*.*\", \"!.git/**/*\", \"!.svn/**/*\"];\n/**\n * 转换\n * @param converConfig 解析配置\n */\nexport async function convert(converConfig: ITableConvertConfig) {\n    //开始时间\n    startTime = new Date().getTime();\n\n    if (!converConfig.projRoot) {\n        converConfig.projRoot = process.cwd();\n    }\n\n    Logger.init(converConfig);\n    const tableFileDir = converConfig.tableFileDir;\n    if (!tableFileDir) {\n        Logger.log(`配置表目录：tableFileDir为空`, \"error\");\n        return;\n    }\n    if (!fs.existsSync(tableFileDir)) {\n        Logger.log(`配置表文件夹不存在：${tableFileDir}`, \"error\");\n        return;\n    }\n\n    if (!converConfig.pattern) {\n        converConfig.pattern = defaultPattern;\n    }\n    if (converConfig.useMultiThread && isNaN(converConfig.threadParseFileMaxNum)) {\n        converConfig.threadParseFileMaxNum = 5;\n    }\n\n    let convertHook: IConvertHook;\n    if (converConfig.customConvertHookPath) {\n        convertHook = require(converConfig.customConvertHookPath);\n    } else {\n        convertHook = new DefaultConvertHook();\n    }\n    let outputTransformer: IOutPutTransformer;\n    if (converConfig.customOutPutTransformerPath) {\n        outputTransformer = require(converConfig.customOutPutTransformerPath);\n    } else {\n        outputTransformer = new DefaultOutPutTransformer();\n    }\n    const context: IConvertContext = {\n        convertConfig: converConfig,\n        outputTransformer: outputTransformer\n    } as any;\n    //开始\n    await new Promise<void>((res) => {\n        convertHook.onStart(context, res);\n    });\n\n\n\n    let parseHandler: ITableParseHandler;\n    if (converConfig.customParseHandlerPath) {\n        parseHandler = require(converConfig.customParseHandlerPath);\n        if (!parseHandler || typeof parseHandler.parseTableFile !== \"function\") {\n            console.error(`自定义解析实现错误:${converConfig.customParseHandlerPath}`);\n            return;\n        }\n    } else {\n        parseHandler = new DefaultParseHandler();\n    }\n    const predoT1 = (new Date()).getTime();\n    getFileInfos(context);\n    const { parseResultMap, parseResultMapCacheFilePath, changedFileInfos } = context;\n    const predoT2 = (new Date()).getTime();\n    Logger.systemLog(`[预处理数据时间:${predoT2 - predoT1}ms,${(predoT2 - predoT1) / 1000}]`);\n    await new Promise<void>((res) => {\n        convertHook.onParseBefore(context, res);\n    });\n    Logger.systemLog(`[开始解析]:数量[${changedFileInfos.length}]`);\n    /**\n     * @type {import(\"worker_threads\").Worker};\n     */\n    let WorkerClass;\n    try {\n        WorkerClass = require(\"worker_threads\");\n    } catch (error) {\n        converConfig.useMultiThread && Logger.systemLog(`node版本不支持Worker多线程，切换为单线程模式`);\n        converConfig.useMultiThread = false;\n    }\n    if (changedFileInfos.length > converConfig.threadParseFileMaxNum && converConfig.useMultiThread) {\n        Logger.systemLog(`[多线程解析]`);\n        let logStr: string = \"\";\n        const count = Math.floor(changedFileInfos.length / converConfig.threadParseFileMaxNum) + 1;\n        /**\n         * @type {import(\"worker_threads\").Worker}\n         */\n        let worker;\n        let subFileInfos: IFileInfo[];\n        /**\n         * @type {import(\"worker_threads\").Worker}\n         */\n        let workerMap: { [key: number]: Worker } = {};\n        let completeCount: number = 0;\n        const t1 = new Date().getTime();\n        const onWorkerParseEnd = (data: IWorkDoResult) => {\n            Logger.log(`----------------线程结束:${data.threadId}-----------------`);\n            const parsedMap = data.parseResultMap;\n            for (let key in parsedMap) {\n                if (!parseResultMap[key].tableDefine) {\n                    parseResultMap[key] = parsedMap[key];\n                }\n            }\n            completeCount++;\n            logStr += data.logStr + Logger.logStr;\n            if (!context.hasError) {\n                context.hasError = Logger.hasError;\n            }\n            if (completeCount >= count) {\n                const t2 = new Date().getTime();\n                Logger.log(`[多线程解析时间]:${t2 - t1}`);\n                onParseEnd(context, parseResultMapCacheFilePath, convertHook, logStr);\n            }\n        };\n        for (let i = 0; i < count; i++) {\n            subFileInfos = changedFileInfos.splice(0, converConfig.threadParseFileMaxNum);\n            Logger.log(`----------------线程开始:${i}-----------------`);\n\n            worker = new WorkerClass(path.join(path.dirname(__filename), \"../../../worker_scripts/worker.js\"), {\n                workerData: {\n                    threadId: i,\n                    fileInfos: subFileInfos,\n                    parseResultMap: parseResultMap,\n                    convertConfig: converConfig\n                } as IWorkerShareData\n            });\n            workerMap[i] = worker;\n            worker.on(\"message\", onWorkerParseEnd);\n        }\n    } else {\n        Logger.systemLog(`[单线程解析]`);\n        if (changedFileInfos.length > 0) {\n            const t1 = new Date().getTime();\n            doParse(converConfig, changedFileInfos, parseResultMap, parseHandler);\n            const t2 = new Date().getTime();\n            Logger.systemLog(`[单线程解析时间]:${t2 - t1}`);\n        }\n        context.hasError = Logger.hasError;\n        onParseEnd(context, parseResultMapCacheFilePath, convertHook);\n    }\n}\n/**\n * 使用fast-glob作为文件遍历\n * 获取需要解析的文件信息\n * @param context \n */\nfunction getFileInfos(context: IConvertContext) {\n    const converConfig = context.convertConfig;\n    let changedFileInfos: IFileInfo[] = [];\n    let deleteFileInfos: IFileInfo[] = [];\n    const tableFileDir = converConfig.tableFileDir;\n    const getFileInfo = (filePath: string) => {\n        const filePathParse = path.parse(filePath);\n        const fileInfo: IFileInfo = {\n            filePath: filePath,\n            fileName: filePathParse.name,\n            fileExtName: filePathParse.ext,\n            isDelete: false\n        };\n        return fileInfo;\n    };\n    const matchPattern = converConfig.pattern;\n\n    const filePaths: string[] = fg.sync(matchPattern, { absolute: true, onlyFiles: true, caseSensitiveMatch: false, cwd: tableFileDir });\n    let parseResultMap: TableParseResultMap = {};\n    //缓存处理\n    let cacheFileDirPath: string = converConfig.cacheFileDirPath;\n    let parseResultMapCacheFilePath: string;\n\n    if (!converConfig.useCache) {\n        for (let i = 0; i < filePaths.length; i++) {\n            changedFileInfos.push(getFileInfo(filePaths[i]))\n        }\n    } else {\n        let t1 = new Date().getTime();\n        if (!cacheFileDirPath) cacheFileDirPath = defaultDir;\n        if (!path.isAbsolute(cacheFileDirPath)) {\n            cacheFileDirPath = path.join(converConfig.projRoot, cacheFileDirPath);\n        }\n        parseResultMapCacheFilePath = path.join(cacheFileDirPath, cacheFileName);\n        Logger.systemLog(`读取缓存数据`);\n\n        parseResultMap = getCacheData(parseResultMapCacheFilePath);\n        if (!parseResultMap) {\n            parseResultMap = {};\n        }\n\n        Logger.systemLog(`开始缓存处理...`);\n        const oldFilePaths = Object.keys(parseResultMap);\n        let oldFilePathIndex: number;\n        let parseResult: ITableParseResult;\n        let filePath:string;\n        for (let i = 0; i < filePaths.length; i++) {\n            filePath = filePaths[i];\n            const fileInfo = getFileInfo(filePath);\n\n            const fileData = fs.readFileSync(filePath);\n            fileInfo.fileData = fileData;\n            parseResult = parseResultMap[filePath];\n            var md5str = getFileMd5(fileData);\n            if (!parseResult || (parseResult && parseResult.md5hash !== md5str)) {\n                parseResult = {\n                    filePath: filePath\n                };\n                parseResultMap[filePath] = parseResult;\n                parseResult.md5hash = md5str;\n                changedFileInfos.push(fileInfo);\n\n            }\n            //删除不存在的旧文件\n            oldFilePathIndex = oldFilePaths.indexOf(filePath);\n            if (oldFilePathIndex > -1) {\n                const endFilePath = oldFilePaths[oldFilePaths.length - 1];\n                oldFilePaths[oldFilePathIndex] = endFilePath;\n                oldFilePaths.pop();\n            }\n        }\n        //删除旧文件\n        for (let i = 0; i < oldFilePaths.length; i++) {\n            delete parseResultMap[oldFilePaths[i]];\n            let deleteFileInfo = getFileInfo(oldFilePaths[i]);;\n            deleteFileInfos.push(deleteFileInfo);\n        }\n        let t2 = new Date().getTime();\n        Logger.systemLog(`缓存处理时间:${t2 - t1}ms,${(t2 - t1) / 1000}s`);\n    }\n    context.deleteFileInfos = deleteFileInfos;\n    context.changedFileInfos = changedFileInfos;\n    context.parseResultMap = parseResultMap;\n    context.parseResultMapCacheFilePath = parseResultMapCacheFilePath;\n\n}\n/**\n * 获取文件信息以及预处理\n * @param context \n */\nfunction getFileInfosAndPreDo(context: IConvertContext) {\n    const converConfig = context.convertConfig;\n    let changedFileInfos: IFileInfo[] = [];\n    let deleteFileInfos: IFileInfo[] = [];\n    const tableFileDir = converConfig.tableFileDir;\n    const getFileInfo = (filePath: string) => {\n        const filePathParse = path.parse(filePath);\n        const fileInfo: IFileInfo = {\n            filePath: filePath,\n            fileName: filePathParse.name,\n            fileExtName: filePathParse.ext,\n            isDelete: false\n        };\n        return fileInfo;\n    };\n    const matchPattern = converConfig.pattern;\n    const eachFileCallback = (filePath: string) => {\n        const fileInfo = getFileInfo(filePath);\n        let canRead: boolean;\n        canRead = mmatch.all(fileInfo.filePath, matchPattern);\n        return { fileInfo, canRead };\n    };\n    let parseResultMap: TableParseResultMap = {};\n\n    //缓存处理\n    let cacheFileDirPath: string = converConfig.cacheFileDirPath;\n    let parseResultMapCacheFilePath: string;\n\n    if (!converConfig.useCache) {\n        forEachFile(tableFileDir, (filePath) => {\n            const { fileInfo, canRead } = eachFileCallback(filePath);\n            if (canRead) {\n                changedFileInfos.push(fileInfo);\n            }\n        });\n    } else {\n        let t1 = new Date().getTime();\n        if (!cacheFileDirPath) cacheFileDirPath = defaultDir;\n        if (!path.isAbsolute(cacheFileDirPath)) {\n            cacheFileDirPath = path.join(converConfig.projRoot, cacheFileDirPath);\n        }\n        parseResultMapCacheFilePath = path.join(cacheFileDirPath, cacheFileName);\n        Logger.systemLog(`读取缓存数据`);\n\n        parseResultMap = getCacheData(parseResultMapCacheFilePath);\n        if (!parseResultMap) {\n            parseResultMap = {};\n        }\n\n        Logger.systemLog(`开始缓存处理...`);\n        const oldFilePaths = Object.keys(parseResultMap);\n        let oldFilePathIndex: number;\n        let parseResult: ITableParseResult;\n        forEachFile(tableFileDir, (filePath) => {\n            const { fileInfo, canRead } = eachFileCallback(filePath);\n\n            const fileData = fs.readFileSync(filePath, isCSV(fileInfo.fileExtName) ? \"utf-8\" : undefined);\n            if (canRead) {\n                fileInfo.fileData = fileData;\n                parseResult = parseResultMap[filePath];\n                var md5str = getFileMd5(fileData);\n                if (!parseResult || (parseResult && parseResult.md5hash !== md5str)) {\n                    parseResult = {\n                        filePath: filePath\n                    };\n                    parseResultMap[filePath] = parseResult;\n                    parseResult.md5hash = md5str;\n                    changedFileInfos.push(fileInfo);\n\n                }\n            }\n            //删除不存在的旧文件\n            oldFilePathIndex = oldFilePaths.indexOf(filePath);\n            if (oldFilePathIndex > -1) {\n                const endFilePath = oldFilePaths[oldFilePaths.length - 1];\n                oldFilePaths[oldFilePathIndex] = endFilePath;\n                oldFilePaths.pop();\n            }\n        });\n        for (let i = 0; i < oldFilePaths.length; i++) {\n            delete parseResultMap[oldFilePaths[i]];\n            let deleteFileInfo = getFileInfo(oldFilePaths[i]);;\n            deleteFileInfos.push(deleteFileInfo);\n        }\n        let t2 = new Date().getTime();\n        Logger.systemLog(`缓存处理时间:${t2 - t1}ms,${(t2 - t1) / 1000}s`);\n    }\n    context.deleteFileInfos = deleteFileInfos;\n    context.changedFileInfos = changedFileInfos;\n    context.parseResultMap = parseResultMap;\n    context.parseResultMapCacheFilePath = parseResultMapCacheFilePath;\n}\n/**\n * 解析结束\n * @param parseConfig\n * @param parseResultMapCacheFilePath\n * @param convertHook\n * @param fileInfos\n * @param deleteFileInfos\n * @param parseResultMap\n * @param logStr\n */\nasync function onParseEnd(\n    context: IConvertContext,\n    parseResultMapCacheFilePath: string,\n    convertHook: IConvertHook,\n    logStr?: string\n) {\n    const convertConfig = context.convertConfig;\n    const parseResultMap = context.parseResultMap;\n    //如果没有错误,则写入解析缓存\n    //有错误不能写入缓存，避免错误被下次解析给忽略掉\n    if (convertConfig.useCache && !context.hasError) {\n        writeCacheData(parseResultMapCacheFilePath, parseResultMap);\n    }\n\n    //解析结束，做导出处理\n    Logger.systemLog(`开始进行转换解析结果`);\n    const parseAfterT1 = new Date().getTime();\n    await new Promise<void>((res) => {\n        convertHook.onParseAfter(context, res);\n    });\n    const parseAfterT2 = new Date().getTime();\n    Logger.systemLog(`转换解析结果结束:${parseAfterT2 - parseAfterT1}ms,${(parseAfterT2 - parseAfterT1) / 1000}s`);\n\n    if (context.outPutFileMap) {\n        const outputFileMap = context.outPutFileMap;\n        const outputFiles = Object.values(outputFileMap);\n        //写入和删除文件处理\n        Logger.systemLog(`开始写入文件:0/${outputFiles.length}`);\n\n        await new Promise<void>((res) => {\n            writeOrDeleteOutPutFiles(\n                outputFiles,\n                (filePath, total, now, isOk) => {\n                    Logger.log(`[写入文件] 进度:(${now}/${total}) 路径:${filePath}`);\n                },\n                () => {\n                    res();\n                }\n            );\n        });\n        Logger.systemLog(`写入结束~`);\n    } else {\n        Logger.systemLog(`没有可写入文件~`);\n    }\n\n    //写入日志文件\n\n    if (!logStr) {\n        logStr = Logger.logStr;\n    }\n    if (logStr.trim() !== \"\") {\n        let logFileDirPath = context.convertConfig.outputLogDirPath as string;\n        if (!logFileDirPath) logFileDirPath = defaultDir;\n        if (!path.isAbsolute(logFileDirPath)) {\n            logFileDirPath = path.join(context.convertConfig.projRoot, logFileDirPath);\n        }\n\n        const outputLogFileInfo: IOutPutFileInfo = {\n            filePath: path.join(logFileDirPath, logFileName),\n            data: logStr\n        };\n        writeOrDeleteOutPutFiles([outputLogFileInfo]);\n    }\n    //写入结束\n    convertHook.onWriteFileEnd(context);\n    //结束时间\n    const endTime = new Date().getTime();\n    const useTime = endTime - startTime;\n    Logger.log(`导表总时间:[${useTime}ms],[${useTime / 1000}s]`);\n}\n/**\n * 测试文件匹配\n * @param convertConfig\n */\nexport function testFileMatch(convertConfig: ITableConvertConfig) {\n    if (!convertConfig.projRoot) {\n        convertConfig.projRoot = process.cwd();\n    }\n    const tableFileDir = convertConfig.tableFileDir;\n    if (!tableFileDir) {\n        Logger.log(`配置表目录：tableFileDir为空`, \"error\");\n        return;\n    }\n    if (!fs.existsSync(tableFileDir)) {\n        Logger.log(`配置表文件夹不存在：${tableFileDir}`, \"error\");\n        return;\n    }\n    if (!convertConfig.pattern) {\n        convertConfig.pattern = defaultPattern;\n    }\n    if (convertConfig.useMultiThread && isNaN(convertConfig.threadParseFileMaxNum)) {\n        convertConfig.threadParseFileMaxNum = 5;\n    }\n    const context: IConvertContext = { convertConfig: convertConfig } as any;\n    let t1 = (new Date()).getTime();\n    getFileInfos(context);\n    let t2 = (new Date()).getTime();\n    console.log(`执行时间:${(t2 - t1) / 1000}s`);\n    if (convertConfig.useCache) {\n        console.log(`----【缓存模式】----`);\n    }\n    console.log(`------------------------------匹配到的文件---------------------`);\n    console.log(context.changedFileInfos);\n}\n"],"names":["os.platform","xlsx.readFile","xlsx.read","TableType","path.join","deflateSync","fs.statSync","fs.readdirSync","fs.existsSync","fs.unlinkSync","fs.ensureFileSync","fs.writeFile","fs.writeFileSync","fs.readFileSync","crypto.createHash","fs.readFile","path","require$$0","path.dirname","path.parse","fg","path.isAbsolute"],"mappings":"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"}