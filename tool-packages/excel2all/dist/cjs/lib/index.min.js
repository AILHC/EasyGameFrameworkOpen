"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("path"),t=require("zlib"),l=require("os"),r=require("fs-extra"),i=require("crypto"),n=require("micromatch"),o=require("worker_threads"),a=require("xlsx");const s="win32"===l.platform()?"\n":"\r\n";var c;!function(e){e[e.info=0]="info",e[e.warn=1]="warn",e[e.error=2]="error",e[e.no=3]="no"}(c||(c={}));class u{static init(e){const t=e.logLevel?e.logLevel:"info";this._logLevel=c[t],this._enableOutPutLogFile=void 0===e.outputLogFile||e.outputLogFile}static log(e,t="info"){if("no"!==t&&this._logLevel<=c[t])switch(t){case"error":console.error(e);break;case"info":console.log(e);break;case"warn":console.warn(e)}this._enableOutPutLogFile&&(this._logStr+=e+s)}static systemLog(e){console.log(e),this._enableOutPutLogFile&&(this._logStr+=e+s)}static get logStr(){if(!this._enableOutPutLogFile)return null;const e=this._logStr;return this._logStr="",e}}u._logStr="";const f={int:"number",json:"any","[int]":"number[]","[string]":"string[]"};class h{onStart(e){u.systemLog("convert-hook onStart")}onParseBefore(e){u.systemLog("convert-hook onParseBefore")}onParseAfter(l){const r=l.convertConfig,i=l.parseResultMap;let n=r.outputConfig;if(!n)return void console.error("parseConfig.outputConfig is undefind");let o,a,c,u={},f={},h="",p="",d={};for(let e in i)o=i[e],o.tableDefine&&(a=o.tableDefine.tableName,c=u[a],c=c?Object.assign(c,o.tableObj):o.tableObj,u[a]=c,n.isGenDts&&void 0===d[a]&&(d[a]=o.tableDefine.tableType===exports.TableType.horizontal,o.tableDefine.tableType===exports.TableType.horizontal?h+="\treadonly "+a+"?: "+`IT_${a};`+s:h+=this._getOneTableTypeStr(a),void 0===n.isBundleDts&&(n.isBundleDts=!0),n.isBundleDts?p+=this._getSingleTableDts(o):this._addSingleTableDtsOutputFile(n,o,f)),n.clientSingleTableJsonDir&&this._addSingleTableJsonOutputFile(n,o,f));if(n.isGenDts){if(h="interface ITBase<T> { [key:string]:T}"+s+"interface IT_TableMap {"+s+h+"}"+s,n.isBundleDts){const t=n.bundleDtsFileName?n.bundleDtsFileName:"tableMap",l=e.join(n.clientDtsOutDir,`${t}.d.ts`);f[l]={filePath:l,data:h+p}}else{const t=e.join(n.clientDtsOutDir,"tableMap.d.ts");f[t]={filePath:t,data:h}}}if(n.clientBundleJsonOutPath){let e,l=n.clientBundleJsonOutPath;if(n.isCompress){const t={};let l,r;for(let e in u)if(d[e])t[e]=u[e];else{l=u[e],r={fieldValuesMap:{}};for(let e in l)r.fieldNames||(r.fieldNames=Object.keys(l[e])),r.fieldValuesMap[e]=Object.values(l[e]);t[e]=r}e=JSON.stringify(t)}else e=JSON.stringify(u);n.isZip&&(e=t.deflateSync(e)),f[l]={filePath:l,encoding:"string"!=typeof e?"binary":"utf-8",data:e}}if(l.outPutFileMap)for(let e in f)l.outPutFileMap[e]=f[e];else l.outPutFileMap=f}onWriteFileEnd(e){u.systemLog("convert-hook onWriteFileEnd \u5199\u5165\u7ed3\u675f")}_addSingleTableDtsOutputFile(t,l,r){if(!l.tableObj)return;let i=e.join(t.clientDtsOutDir,`${l.tableDefine.tableName}.d.ts`);if(!r[i]){const e=this._getSingleTableDts(l);e&&(r[i]={filePath:i,data:e})}}_getSingleTableDts(e){const t=e.tableDefine.tableName,l=e.filedMap;let r,i="interface IT_"+t+" {"+s,n={};for(let e in l)if(r=l[e],r)if(r.isMutiColObj){const e=r.fieldName;n[e]||(n[e]=""),n[e]+="\t\t/** "+r.text+" */"+s,n[e]+="\t\treadonly "+r.subFieldName+"?: "+(f[r.subType]?f[r.subType]:r.subType)+";"+s}else i+="\t/** "+r.text+" */"+s,i+="\treadonly "+r.fieldName+"?: "+(f[r.type]?f[r.type]:r.type)+";"+s;for(let e in n)i+="\treadonly "+e+"?: {"+s+n[e],i+="\t}"+s;return i+="}"+s,i}_addSingleTableJsonOutputFile(t,l,r){const i=l.tableObj;if(!i)return;const n=l.tableDefine.tableName;let o=e.join(t.clientSingleTableJsonDir,`${n}.json`),a=JSON.stringify(i,null,"\t"),s=r[o];s?s.data=a:(s={filePath:o,data:a},r[o]=s)}_getOneTableTypeStr(e){return"\treadonly "+e+"?: ITBase<IT_"+e+">;"+s}}const p={};function d(e,t,l,r){let i;for(let n=t.length-1;n>=0;n--)i=l[t[n].filePath],i||(i={filePath:t[n].filePath}),i.tableObj||(i=r.parseTableFile(e,t[n],i)),i&&(l[t[n].filePath]=i)}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function g(e,t,l,r){return new(l||(l=Promise))((function(i,n){function o(e){try{s(r.next(e))}catch(e){n(e)}}function a(e){try{s(r.throw(e))}catch(e){n(e)}}function s(e){e.done?i(e.value):new l((function(t){t(e.value)})).then(o,a)}s((r=r.apply(e,t||[])).next())}))}function b(t,l){if(r.statSync(t).isDirectory()){const n=r.readdirSync(t);let o;for(var i=0;i<n.length;i++)o=e.join(t,n[i]),b(o,l)}else l(t)}function y(e,t,l){let i;const n=e.length;if(e&&n){let o=0;const a=r=>{r&&u.log(r,"error"),o++,t&&t(e[o-1].filePath,n,o,!r),o>=n&&l&&l(n)};for(let t=e.length-1;t>=0;t--)if(i=e[t],i.isDelete&&r.existsSync(i.filePath))r.unlinkSync(i.filePath);else{if(r.existsSync(i.filePath)&&r.statSync(i.filePath).isDirectory()){u.log(`\u8def\u5f84\u4e3a\u6587\u4ef6\u5939:${i.filePath}`,"error");continue}i.encoding||"string"!=typeof i.data||(i.encoding="utf8"),r.ensureFileSync(i.filePath),r.writeFile(i.filePath,i.data,i.encoding?{encoding:i.encoding}:void 0,a)}}}function m(e,t){e?r.writeFileSync(e,JSON.stringify(t),{encoding:"utf-8"}):u.log("cacheFilePath is null","error")}function v(e){if(!e)return void u.log("cacheFilePath is null","error");r.existsSync(e)||(r.ensureFileSync(e),r.writeFileSync(e,"{}",{encoding:"utf-8"}));const t=r.readFileSync(e,"utf-8");return JSON.parse(t)}function T(e){const t=r.readFileSync(e,"utf-8");var l=i.createHash("md5");return l.update(t),l.digest("hex")}function F(t,l,r,i){return g(this,void 0,void 0,(function*(){const n=t.convertConfig,o=t.parseResultMap;if(n.useCache&&m(l,o),r.onParseAfter(t),t.outPutFileMap){const e=t.outPutFileMap,l=Object.values(e);u.systemLog(`\u5f00\u59cb\u5199\u5165\u6587\u4ef6:0/${l.length}`),yield new Promise((e=>{y(l,((e,t,l,r)=>{u.log(`[\u5199\u5165\u6587\u4ef6] \u8fdb\u5ea6:(${l}/${t}) \u8def\u5f84:${e}`)}),(()=>{e()}))})),u.systemLog("\u5199\u5165\u7ed3\u675f~")}else u.systemLog("\u6ca1\u6709\u53ef\u5199\u5165\u6587\u4ef6~");i||(i=u.logStr);y([{filePath:e.join(process.cwd(),"excel2all.log"),data:i}]),r.onWriteFileEnd(t)}))}function N(e){return!e||void 0===e.v||("string"==typeof e.v?""===e.v:"number"==typeof e.v&&isNaN(e.v))}p.int=function(e,t){let l={};"string"==typeof t&&""!==t.trim()?l.value=t.includes(".")?parseFloat(t):parseInt(t):"number"==typeof t&&(l.value=t);return l},p.string=function(e,t){let l={};"string"==typeof t?""!==(t=t.trim())&&(l.value=t):l.value=t+"";return l},p["[int]"]=function(e,t){let l;t=(t=(t+"").replace(/\uff0c/g,",")).trim();const r={};if(""!==t)try{l=JSON.parse(t),r.value=l}catch(e){r.error=e}return r},p["[string]"]=function(e,t){t=(t=(t+"").replace(/\uff0c/g,",")).trim();let l,r={};if(""!==t)try{l=JSON.parse(t),r.value=l}catch(e){r.error=e}return r},p.json=function(e,t){let l,r;if(""!==(t=(t=(t+"").replace(/\uff0c/g,",")).trim()))try{l=JSON.parse(t)}catch(e){r=e,l=t}return{error:r,value:l}};function P(e){let t;for(let l=e.length-1;l>=0;l--){if(e[l]<90){e[l]+=1,t=!0;break}90===e[l]&&(e[l]=65)}return t||e.push(65),x(e)}function x(e){return String.fromCharCode(...e)}function S(e){const t=[];for(let l=0;l<e.length;l++)t.push(e.charCodeAt(l));return t}function C(e,t,l,r,i,n,o,a){const s=e["!ref"],c=parseInt(s.match(/\d+$/)[0]);let u,f,h=w(s.split(":")[1].match(/^[A-Za-z]+/)[0]),p=0;const d=S(l);for(let s=t;s<=c&&(!i||!i(e,s));s++){if(o&&o(e,s))continue;u=d.concat([]),f=l;let t=!n||!n(e,f);for(;t;)a&&a(e,f)||r(e,f,s),f=P(u),p=w(f),t=h>=p&&(!n||!n(e,f))}}function D(e,t,l,r,i,n,o,a){const s=e["!ref"],c=parseInt(s.match(/\d+$/)[0]),u=w(s.split(":")[1].match(/^[A-Za-z]+/)[0]);let f,h;f=S(l);let p=0;h=l;let d=!n||!n(e,h);for(;d;){if(!a||!a(e,h))for(let l=t;l<=c&&(!i||!i(e,l));l++)o&&o(e,l)||r(e,h,l);h=P(f),p=w(h),d=u>=p&&(!n||!n(e,h))}}let O={};function w(e){let t=O[e];if(!t){t=0;for(let l=0;l<e.length;l++)t+=e.charCodeAt(l);O[e]=t}return t}function j(e){return a.readFile(e.filePath,{type:M(e.fileExtName)?"string":"file"})}function M(e){return"csv"===e}var R;(R=exports.TableType||(exports.TableType={})).vertical="vertical",R.horizontal="horizontal";class _{constructor(){this._valueTransFuncMap=p}getTableDefine(e,t){const l=e.fileName,r={tableName:l};let i,n;const o=t.SheetNames;let a,s,c;for(let e=0;e<o.length&&(a=t.Sheets[o[e]],c=a.A1,N(c)||(s=this._getFirstCellValue(c),!s||s.tableNameInSheet!==l));e++);if(!s||s.tableNameInSheet!==l)return u.log(`\u8868\u683c\u4e0d\u89c4\u8303,\u8df3\u8fc7\u89e3\u6790,\u8def\u5f84:${e.filePath}`,"error"),null;if(r.tableType=s.tableType,r.tableType===exports.TableType.vertical){r.verticalFieldDefine={};const e=r.verticalFieldDefine;e.textRow=1;for(let t=1;t<100&&(i="A"+t,n=a[i],N(n)||"NO"===n.v||"END"===n.v||"START"===n.v?r.startRow=t:"CLIENT"===n.v?e.fieldRow=t:"TYPE"===n.v&&(e.typeRow=t),!(r.startRow&&e.fieldRow&&e.typeRow));t++);r.startCol="B"}else if(r.tableType===exports.TableType.horizontal){r.horizontalFieldDefine={};const e=r.horizontalFieldDefine;e.textCol="A",e.typeCol="B",e.fieldCol="C",r.startCol="E",r.startRow=2}return r}_getFirstCellValue(e){if(!e)return;const t=e.v.split(":");let l,r;return t.length>1?(l=t[1],r="H"===t[0]?exports.TableType.horizontal:exports.TableType.vertical):(l=t[0],r=exports.TableType.vertical),{tableNameInSheet:l,tableType:r}}checkSheetCanParse(e,t,l){const r=t.A1,i=this._getFirstCellValue(r);return!(!r||!e)&&i.tableNameInSheet===e.tableName}isSheetRowEnd(e,t,l){if(l>1){const e=t["A"+(l-=1)];return e&&"END"===e.v}return!1}isSheetColEnd(e,t,l){return N(t[l+1])}checkRowNeedParse(e,t,l){const r=t["A"+l];return!r||"NO"!==r.v}parseVerticalCell(e,t,l,r,i){const n=this.getVerticalTableField(e,t,l,r);if(!n)return;const o=t[l+r];if(N(o))return;const a=this.transValue(e,n,o.v);a.error&&(u.log(`\u8868\u683c:${e.filePath},\u5206\u8868:${e.curSheetName},\u884c:${r},\u5217\uff1a${l}\u89e3\u6790\u51fa\u9519`,"error"),u.log(a.error,"error"));const s=a.value;let c=e.mainKeyFieldName;c||(c=n.fieldName,e.mainKeyFieldName=n.fieldName,e.tableObj={});let f=e.curRowOrColObj;if(i&&(f={},e.curRowOrColObj=e.tableObj[s]=f),n.isMutiColObj){let e=f[n.fieldName];e||(e={},f[n.fieldName]=e),e[n.subFieldName]=s}else f[n.fieldName]=s}parseHorizontalCell(e,t,l,r,i){const n=this.getHorizontalTableField(e,t,l,r);if(!n)return;const o=t[l+r];if(N(o))return;const a=this.transValue(e,n,o.v);a.error&&(u.log(`\u8868\u683c:${e.filePath},\u5206\u8868:${e.curSheetName},\u884c:${r},\u5217\uff1a${l}\u89e3\u6790\u51fa\u9519`,"error"),u.log(a.error,"error"));const s=a.value;if(e.tableObj||(e.tableObj={}),n.isMutiColObj){let t=e.tableObj[n.fieldName];t||(t={},e.tableObj[n.fieldName]=t),t[n.subFieldName]=s}else e.tableObj[n.fieldName]=s}getVerticalTableField(e,t,l,r){const i=e.tableDefine;let n=e.filedMap;n||(n={},e.filedMap=n);const o=i.verticalFieldDefine,a=t[l+o.fieldRow];let s;if(N(a)||(s=a.v),!s)return null;let c={};if(void 0!==n[s])return n[s];const u=t[l+o.textRow];N(u)||(c.text=u.v);let f=!1;const h=t[l+o.typeRow];if(N(h))return null;if(c.originType=h.v,c.originType.includes("mf:")){const e=c.originType.split(":");if(e.length<3)return null;c.type=e[2],f=!0}else c.type=c.originType;if(c.isMutiColObj=f,c.originFieldName=s,f){const e=c.originFieldName.split(":");if(e.length<2)return null;c.fieldName=e[0],c.subFieldName=e[1]}else c.fieldName=c.originFieldName;return n[l]=c,c}getHorizontalTableField(e,t,l,r){const i=e.tableDefine;let n=e.filedMap;n||(n={},e.filedMap=n);const o=i.horizontalFieldDefine,a=t[o.fieldCol+r];let s;if(N(a)||(s=a.v),!s)return null;if(void 0!==n[s])return n[s];let c={};const u=t[o.textCol+r];N(u)||(c.text=u.v);let f=!1;const h=t[o.typeCol+r];if(N(h))return null;if(c.originType=h.v,c.originType.includes("mf:")){const e=c.originType.split(":");if(e.length<3)return null;c.type=e[2],f=!0}else c.type=c.originType;if(c.isMutiColObj=f,c.originFieldName=s,f){const e=c.originFieldName.split(":");if(e.length<2)return null;c.fieldName=e[0],c.subFieldName=e[1]}else c.fieldName=c.originFieldName;return n[s]=c,c}checkColNeedParse(e,t,l){if(e.tableType===exports.TableType.vertical){const r=e.verticalFieldDefine,i=t[l+r.typeRow],n=t[l+r.fieldRow];return!N(i)&&!N(n)}if(e.tableType===exports.TableType.horizontal){return!N(t[l+1])}}transValue(e,t,l){let r,i=this._valueTransFuncMap[t.type];return i||(i=this._valueTransFuncMap.json),r=i(t,l),r}parseTableFile(e,t,l){const r=j(t);if(!r.SheetNames.length)return;const i=r.SheetNames,n=this.getTableDefine(t,r);for(let e=0;e<i.length;e++);if(!n)return null;let o,a;const s=this.isSheetRowEnd.bind(null,n),c=this.isSheetColEnd.bind(null,n),f=(e,t)=>!this.checkRowNeedParse(n,e,t),h=(e,t)=>!this.checkColNeedParse(n,e,t);let p;l.tableDefine=n;for(let e=0;e<i.length;e++)if(o=i[e],a=r.Sheets[o],this.checkSheetCanParse(n,a,o))if(l.curSheetName=o,u.log(`\u89e3\u6790:${t.filePath}=> sheet:${o} ....`),n.tableType===exports.TableType.vertical){let e;C(a,n.startRow,n.startCol,((t,r,i)=>{let n=!1;e!==i&&(e=i,n=!0),p=t[r+i],N(p)||this.parseVerticalCell(l,t,r,i,n)}),s,c,f,h)}else if(n.tableType===exports.TableType.horizontal){let e;D(a,n.startRow,n.startCol,((t,r,i)=>{let n=!1;e!==r&&(e=r,n=!0),p=t[r+i],N(p)||this.parseHorizontalCell(l,t,r,i,n)}),s,c,f,h)}return l}}exports.ACharCode=65,exports.DefaultConvertHook=h,exports.DefaultParseHandler=_,exports.Logger=u,exports.ZCharCode=90,exports.charCodesToString=x,exports.convert=function(t){return g(this,void 0,void 0,(function*(){let l;t.projRoot||(t.projRoot=process.cwd()),l=t.customConvertHookPath?require(t.customConvertHookPath):new h;const i=t.tableFileDir;if(!i)return void u.log("\u914d\u7f6e\u8868\u76ee\u5f55\uff1atableFileDir\u4e3a\u7a7a","error");if(!r.existsSync(i))return void u.log(`\u914d\u7f6e\u8868\u6587\u4ef6\u5939\u4e0d\u5b58\u5728\uff1a${i}`,"error");const a=["**/*.{xlsx,csv}","!**/~$*.*","!**/~.*.*"];t.pattern||(t.pattern=a),t.useMultiThread&&isNaN(t.threadParseFileMaxNum)&&(t.threadParseFileMaxNum=5),u.init(t);const s={convertConfig:t};l.onStart(s);let c=[],f=[];const p=t.pattern,g=(t,l)=>{const r=(t=>{const l=e.parse(t);return{filePath:t,fileName:l.name,fileExtName:l.ext,isDelete:!1}})(t);let i;return l?f.push(r):(i=n.all(r.filePath,p),i&&c.push(r)),{fileInfo:r,canRead:i}};let y,m,N={},P=t.cacheFileDirPath;if(t.useCache){P||(P=".cache"),e.isAbsolute(P)||(P=e.join(t.projRoot,P)),y=e.join(P,".egfprmc"),N=v(y),N||(N={});const l=Object.keys(N);let r,n;b(i,(e=>{var t=T(e);if(n=N[e],n||(n={filePath:e},N[e]=n),n&&n.md5hash!==t){const{fileInfo:l,canRead:r}=g(e,!1);r&&(n.md5hash=t)}if(r=l.indexOf(e),r>-1){const e=l[l.length-1];l[r]=e,l.pop()}}));for(let e=0;e<l.length;e++)delete N[l[e]],g(l[e],!0)}else b(i,g);if(t.customParseHandlerPath){if(m=require(t.customParseHandlerPath),!m||"function"!=typeof m.parseTableFile)return void console.error(`\u81ea\u5b9a\u4e49\u89e3\u6790\u5b9e\u73b0\u9519\u8bef:${t.customParseHandlerPath}`)}else m=new _;if(s.parseResultMap=N,s.deleteFileInfos=f,s.changedFileInfos=c,l.onParseBefore(s),c.length>t.threadParseFileMaxNum&&t.useMultiThread){let r="";const i=Math.floor(c.length/t.threadParseFileMaxNum)+1;let n,a,f=0;const h=(new Date).getTime(),p=e=>{u.log(`----------------\u7ebf\u7a0b\u7ed3\u675f:${e.threadId}-----------------`);const t=e.parseResultMap;for(let e in t)N[e].tableDefine||(N[e]=t[e]);if(f++,r+=e.logStr+u.logStr,f>=i){const e=(new Date).getTime();u.log("[\u591a\u7ebf\u7a0b\u5bfc\u8868\u65f6\u95f4]:"+(e-h)),F(s,y,l,r)}};for(let l=0;l<i;l++)a=c.splice(0,t.threadParseFileMaxNum),u.log(`----------------\u7ebf\u7a0b\u5f00\u59cb:${l}-----------------`),n=new o.Worker(e.join(e.dirname(__filename),"../../../worker_scripts/worker.js"),{workerData:{threadId:l,fileInfos:a,parseResultMap:N,parseConfig:t}}),n.on("message",p)}else{const e=(new Date).getTime();d(t,c,N,m);const r=(new Date).getTime();u.systemLog("[\u5355\u7ebf\u7a0b\u5bfc\u8868\u65f6\u95f4]:"+(r-e)),F(s,y,l)}}))},exports.doParse=d,exports.forEachChangedFile=function(e,t,l){const i=v(t),n=Object.keys(i);let o;b(e,(e=>{var t=T(e);if((!i[e]||i[e]&&i[e]!==t)&&(i[e]=t,l(e,!1)),o=n.indexOf(e),o>-1){const e=n[n.length-1];n[o]=e,n.pop()}}));for(let e=0;e<n.length;e++)delete i[n[e]],l(n[e],!0);r.writeFileSync(t,JSON.stringify(i),{encoding:"utf-8"})},exports.forEachFile=b,exports.getCacheData=v,exports.getFileMd5=function(e){return g(this,void 0,void 0,(function*(){return T(e)}))},exports.getFileMd5Sync=T,exports.getNextColKey=P,exports.horizontalForEachSheet=D,exports.isCSV=M,exports.isEmptyCell=N,exports.readTableFile=j,exports.stringToCharCodes=S,exports.testFileMatch=function(t){t.projRoot||(t.projRoot=process.cwd()),t.customConvertHookPath&&require(t.customConvertHookPath);const l=t.tableFileDir;if(!l)return void u.log("\u914d\u7f6e\u8868\u76ee\u5f55\uff1atableFileDir\u4e3a\u7a7a","error");if(!r.existsSync(l))return void u.log(`\u914d\u7f6e\u8868\u6587\u4ef6\u5939\u4e0d\u5b58\u5728\uff1a${l}`,"error");const i=["**/*.{xlsx,csv}","!**/~$*.*","!**/~.*.*"];t.pattern||(t.pattern=i),t.useMultiThread&&isNaN(t.threadParseFileMaxNum)&&(t.threadParseFileMaxNum=5);const o=t.pattern,a=[],s=(e,t)=>{let l;return t||(l=n.all(e,o),l&&a.push(e)),{canRead:l}};let c,f,h=t.cacheFileDirPath;if(t.useCache){h||(h=".cache"),e.isAbsolute(h)||(h=e.join(t.projRoot,h)),c=e.join(h,".egfprmc"),f=v(c),f||(f={});const r=Object.keys(f);let i,n;b(l,(e=>{var t=T(e);if(n=f[e],n||(n={filePath:e},f[e]=n),n&&n.md5hash!==t){const{canRead:l}=s(e,!1);l&&(n.md5hash=t)}if(i=r.indexOf(e),i>-1){const e=r[r.length-1];r[i]=e,r.pop()}}));for(let e=0;e<r.length;e++)delete f[r[e]],s(r[e],!0)}else b(l,s);t.useCache&&console.log("----\u3010\u7f13\u5b58\u6a21\u5f0f\u3011----"),console.log("------------------------------\u5339\u914d\u5230\u7684\u6587\u4ef6---------------------"),console.log(a)},exports.valueTransFuncMap=p,exports.verticalForEachSheet=C,exports.writeCacheData=m,exports.writeOrDeleteOutPutFiles=y;
