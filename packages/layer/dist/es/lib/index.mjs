var LayerMgr = (function () {
    function LayerMgr() {
    }
    LayerMgr.prototype.init = function (layerEnum, defaultClass, classMap, root) {
        if (root)
            this._root = root;
        this.layerEnum = layerEnum;
        this.defaultType = defaultClass;
        this.classMap = classMap;
        var len = Object.keys(layerEnum).length / 2;
        var layerClassNameAndLayerName;
        var layerName;
        var layer;
        var clas;
        var className;
        for (var i = 0; i < len; i++) {
            layerClassNameAndLayerName = layerEnum[i].split("_");
            className = layerClassNameAndLayerName[0];
            layerName = layerClassNameAndLayerName[1];
            if (!layerName) {
                layerName = className;
            }
            if (classMap && this.classMap.has(className)) {
                clas = this.classMap.get(className);
            }
            else {
                clas = defaultClass;
            }
            layer = new clas();
            layer.onInit(layerName, i, this);
            this.addLayer(layer);
        }
    };
    LayerMgr.prototype.setLayerRoot = function (root) {
        if (!root)
            return;
        this._root = root;
        if (this._layerMap) {
            this._layerMap.forEach(function (value) {
                value.onAdd(root);
            });
        }
    };
    Object.defineProperty(LayerMgr.prototype, "root", {
        get: function () {
            return this._root;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(LayerMgr.prototype, "layerMap", {
        get: function () {
            return this._layerMap;
        },
        enumerable: false,
        configurable: true
    });
    LayerMgr.prototype.addLayer = function (layer) {
        if (!this._layerMap) {
            this._layerMap = new Map();
        }
        var layerType = layer.layerType;
        if (this._layerMap.has(layerType)) {
            console.warn("\u3010\u5C42\u7EA7\u7BA1\u7406\u5668\u3011\u91CD\u590D\u6DFB\u52A0\u5C42\u7EA7 type:" + layerType + ",name:" + layer.layerName);
            return false;
        }
        this._layerMap.set(layerType, layer);
        if (this._root) {
            layer.onAdd(this._root);
        }
        return true;
    };
    LayerMgr.prototype.removeLayer = function (layerType) {
        if (!this._layerMap || !this._layerMap.has(layerType)) {
            return false;
        }
        var layer = this._layerMap.get(layerType);
        layer.onDestroy && layer.onDestroy();
        this._layerMap.delete(layerType);
        return true;
    };
    LayerMgr.prototype.hideLayer = function (layerType) {
        var layer = this.getLayerByType(layerType);
        if (layer) {
            layer.onHide();
        }
    };
    LayerMgr.prototype.showLayer = function (layerType) {
        var layer = this.getLayerByType(layerType);
        if (layer) {
            layer.onShow();
        }
    };
    LayerMgr.prototype.addNodeToLayer = function (node, layerType) {
        var layer = this.getLayerByType(layerType);
        if (layer) {
            layer.onNodeAdd(node);
        }
    };
    LayerMgr.prototype.getLayerByType = function (layerType) {
        var layer = this._layerMap.get(layerType);
        if (!layer) {
            console.warn("\u3010\u5C42\u7EA7\u7BA1\u7406\u5668\u3011\u6CA1\u6709\u8FD9\u4E2A\u5C42\u7EA7:" + this.layerEnum[layerType] + "," + layerType);
        }
        return layer;
    };
    return LayerMgr;
}());

export { LayerMgr };

    
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXgubWpzIiwic291cmNlcyI6WyJAYWlsaGMvbGF5ZXIvc3JjL2xheWVyLW1nci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJ0eXBlIExheWVyQ2xhc3NUeXBlID0gbGF5ZXIuTGF5ZXJDbGFzc1R5cGU7XG5cbmV4cG9ydCBjbGFzcyBMYXllck1ncjxUPiBpbXBsZW1lbnRzIGxheWVyLklNZ3I8VD4ge1xuXG5cbiAgICBwcm90ZWN0ZWQgbGF5ZXJFbnVtOiBhbnk7XG4gICAgcHJvdGVjdGVkIGNsYXNzTWFwOiBNYXA8c3RyaW5nLCBMYXllckNsYXNzVHlwZT47XG4gICAgcHJvdGVjdGVkIGRlZmF1bHRUeXBlOiBMYXllckNsYXNzVHlwZTtcbiAgICBwcm90ZWN0ZWQgX2xheWVyTWFwOiBNYXA8bnVtYmVyLCBsYXllci5JTGF5ZXIgfCBhbnk+O1xuICAgIHByaXZhdGUgX3Jvb3Q6IFQ7XG5cbiAgICBwdWJsaWMgaW5pdChsYXllckVudW06IGFueSxcbiAgICAgICAgZGVmYXVsdENsYXNzOiBMYXllckNsYXNzVHlwZVxuICAgICAgICAsIGNsYXNzTWFwPzogTWFwPHN0cmluZywgTGF5ZXJDbGFzc1R5cGU+XG4gICAgICAgICwgcm9vdD86IFQpIHtcbiAgICAgICAgaWYgKHJvb3QpIHRoaXMuX3Jvb3QgPSByb290O1xuICAgICAgICB0aGlzLmxheWVyRW51bSA9IGxheWVyRW51bTtcbiAgICAgICAgdGhpcy5kZWZhdWx0VHlwZSA9IGRlZmF1bHRDbGFzcztcbiAgICAgICAgdGhpcy5jbGFzc01hcCA9IGNsYXNzTWFwO1xuICAgICAgICBjb25zdCBsZW4gPSBPYmplY3Qua2V5cyhsYXllckVudW0pLmxlbmd0aCAvIDI7XG4gICAgICAgIGxldCBsYXllckNsYXNzTmFtZUFuZExheWVyTmFtZTogc3RyaW5nW107XG4gICAgICAgIGxldCBsYXllck5hbWU6IHN0cmluZztcbiAgICAgICAgbGV0IGxheWVyOiBsYXllci5JTGF5ZXI7XG4gICAgICAgIGxldCBjbGFzOiBMYXllckNsYXNzVHlwZTtcbiAgICAgICAgbGV0IGNsYXNzTmFtZTogc3RyaW5nO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBsYXllckNsYXNzTmFtZUFuZExheWVyTmFtZSA9IGxheWVyRW51bVtpXS5zcGxpdChcIl9cIik7XG4gICAgICAgICAgICBjbGFzc05hbWUgPSBsYXllckNsYXNzTmFtZUFuZExheWVyTmFtZVswXTtcbiAgICAgICAgICAgIGxheWVyTmFtZSA9IGxheWVyQ2xhc3NOYW1lQW5kTGF5ZXJOYW1lWzFdXG4gICAgICAgICAgICBpZiAoIWxheWVyTmFtZSkge1xuICAgICAgICAgICAgICAgIGxheWVyTmFtZSA9IGNsYXNzTmFtZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjbGFzc01hcCAmJiB0aGlzLmNsYXNzTWFwLmhhcyhjbGFzc05hbWUpKSB7XG4gICAgICAgICAgICAgICAgY2xhcyA9IHRoaXMuY2xhc3NNYXAuZ2V0KGNsYXNzTmFtZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNsYXMgPSBkZWZhdWx0Q2xhc3M7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsYXllciA9IG5ldyBjbGFzKCk7XG4gICAgICAgICAgICBsYXllci5vbkluaXQobGF5ZXJOYW1lLCBpLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuYWRkTGF5ZXIobGF5ZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHB1YmxpYyBzZXRMYXllclJvb3Qocm9vdDogVCk6IHZvaWQge1xuICAgICAgICBpZiAoIXJvb3QpIHJldHVybjtcbiAgICAgICAgdGhpcy5fcm9vdCA9IHJvb3Q7XG4gICAgICAgIGlmICh0aGlzLl9sYXllck1hcCkge1xuICAgICAgICAgICAgdGhpcy5fbGF5ZXJNYXAuZm9yRWFjaCgodmFsdWU6IGxheWVyLklMYXllcikgPT4ge1xuICAgICAgICAgICAgICAgIHZhbHVlLm9uQWRkKHJvb3QpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cbiAgICBwdWJsaWMgZ2V0IHJvb3QoKTogVCB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yb290O1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgbGF5ZXJNYXAoKTogTWFwPG51bWJlciwgbGF5ZXIuSUxheWVyIHwgYW55PiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9sYXllck1hcDtcbiAgICB9XG4gICAgcHVibGljIGFkZExheWVyKGxheWVyOiBsYXllci5JTGF5ZXIpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCF0aGlzLl9sYXllck1hcCkge1xuICAgICAgICAgICAgdGhpcy5fbGF5ZXJNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGF5ZXJUeXBlID0gbGF5ZXIubGF5ZXJUeXBlO1xuICAgICAgICBpZiAodGhpcy5fbGF5ZXJNYXAuaGFzKGxheWVyVHlwZSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybihg44CQ5bGC57qn566h55CG5Zmo44CR6YeN5aSN5re75Yqg5bGC57qnIHR5cGU6JHtsYXllclR5cGV9LG5hbWU6JHtsYXllci5sYXllck5hbWV9YCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fbGF5ZXJNYXAuc2V0KGxheWVyVHlwZSwgbGF5ZXIpO1xuICAgICAgICBpZiAodGhpcy5fcm9vdCkge1xuICAgICAgICAgICAgbGF5ZXIub25BZGQodGhpcy5fcm9vdCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHB1YmxpYyByZW1vdmVMYXllcihsYXllclR5cGU6IG51bWJlcik6IGJvb2xlYW4ge1xuICAgICAgICBpZiAoIXRoaXMuX2xheWVyTWFwIHx8ICF0aGlzLl9sYXllck1hcC5oYXMobGF5ZXJUeXBlKSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGxheWVyOiBsYXllci5JTGF5ZXIgPSB0aGlzLl9sYXllck1hcC5nZXQobGF5ZXJUeXBlKTtcbiAgICAgICAgbGF5ZXIub25EZXN0cm95ICYmIGxheWVyLm9uRGVzdHJveSgpO1xuICAgICAgICB0aGlzLl9sYXllck1hcC5kZWxldGUobGF5ZXJUeXBlKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHB1YmxpYyBoaWRlTGF5ZXIobGF5ZXJUeXBlOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbGF5ZXIgPSB0aGlzLmdldExheWVyQnlUeXBlKGxheWVyVHlwZSk7XG4gICAgICAgIGlmIChsYXllcikge1xuICAgICAgICAgICAgbGF5ZXIub25IaWRlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHVibGljIHNob3dMYXllcihsYXllclR5cGU6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBjb25zdCBsYXllciA9IHRoaXMuZ2V0TGF5ZXJCeVR5cGUobGF5ZXJUeXBlKTtcbiAgICAgICAgaWYgKGxheWVyKSB7XG4gICAgICAgICAgICBsYXllci5vblNob3coKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwdWJsaWMgYWRkTm9kZVRvTGF5ZXIobm9kZTogVCwgbGF5ZXJUeXBlOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbGF5ZXIgPSB0aGlzLmdldExheWVyQnlUeXBlKGxheWVyVHlwZSk7XG4gICAgICAgIGlmIChsYXllcikge1xuICAgICAgICAgICAgbGF5ZXIub25Ob2RlQWRkKG5vZGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldExheWVyQnlUeXBlPFQgZXh0ZW5kcyBsYXllci5JTGF5ZXI+KGxheWVyVHlwZTogbnVtYmVyKTogVCB7XG4gICAgICAgIGNvbnN0IGxheWVyID0gdGhpcy5fbGF5ZXJNYXAuZ2V0KGxheWVyVHlwZSk7XG4gICAgICAgIGlmICghbGF5ZXIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybihg44CQ5bGC57qn566h55CG5Zmo44CR5rKh5pyJ6L+Z5Liq5bGC57qnOiR7dGhpcy5sYXllckVudW1bbGF5ZXJUeXBlXX0sJHtsYXllclR5cGV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxheWVyO1xuICAgIH1cblxuXG59Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7SUFFQTtLQTRHQztJQW5HVSx1QkFBSSxHQUFYLFVBQVksU0FBYyxFQUN0QixZQUE0QixFQUMxQixRQUFzQyxFQUN0QyxJQUFRO1FBQ1YsSUFBSSxJQUFJO1lBQUUsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7UUFDNUIsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7UUFDM0IsSUFBSSxDQUFDLFdBQVcsR0FBRyxZQUFZLENBQUM7UUFDaEMsSUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7UUFDekIsSUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO1FBQzlDLElBQUksMEJBQW9DLENBQUM7UUFDekMsSUFBSSxTQUFpQixDQUFDO1FBQ3RCLElBQUksS0FBbUIsQ0FBQztRQUN4QixJQUFJLElBQW9CLENBQUM7UUFDekIsSUFBSSxTQUFpQixDQUFDO1FBQ3RCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDMUIsMEJBQTBCLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNyRCxTQUFTLEdBQUcsMEJBQTBCLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFDMUMsU0FBUyxHQUFHLDBCQUEwQixDQUFDLENBQUMsQ0FBQyxDQUFBO1lBQ3pDLElBQUksQ0FBQyxTQUFTLEVBQUU7Z0JBQ1osU0FBUyxHQUFHLFNBQVMsQ0FBQzthQUN6QjtZQUNELElBQUksUUFBUSxJQUFJLElBQUksQ0FBQyxRQUFRLENBQUMs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
