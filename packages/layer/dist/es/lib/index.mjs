var LayerMgr = (function () {
    function LayerMgr() {
    }
    LayerMgr.prototype.init = function (layerEnum, defaultClass, classMap, root) {
        if (root)
            this._root = root;
        this.layerEnum = layerEnum;
        this.defaultType = defaultClass;
        this.classMap = classMap;
        var len = Object.keys(layerEnum).length / 2;
        var layerClassNameAndLayerName;
        var layerName;
        var layer;
        var clas;
        var className;
        for (var i = 0; i < len; i++) {
            layerClassNameAndLayerName = layerEnum[i].split("_");
            className = layerClassNameAndLayerName[0];
            layerName = layerClassNameAndLayerName[1];
            if (!layerName) {
                layerName = className;
            }
            if (classMap && this.classMap.has(className)) {
                clas = this.classMap.get(className);
            }
            else {
                clas = defaultClass;
            }
            layer = new clas();
            layer.onInit(layerName, i, this);
            this.addLayer(layer);
        }
    };
    LayerMgr.prototype.setLayerRoot = function (root) {
        if (!root)
            return;
        this._root = root;
        if (this._layerMap) {
            this._layerMap.forEach(function (value) {
                value.onAdd(root);
            });
        }
    };
    Object.defineProperty(LayerMgr.prototype, "root", {
        get: function () {
            return this._root;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(LayerMgr.prototype, "layerMap", {
        get: function () {
            return this._layerMap;
        },
        enumerable: false,
        configurable: true
    });
    LayerMgr.prototype.addLayer = function (layer) {
        if (!this._layerMap) {
            this._layerMap = new Map();
        }
        var layerType = layer.layerType;
        if (this._layerMap.has(layerType)) {
            console.warn("\u3010\u5C42\u7EA7\u7BA1\u7406\u5668\u3011\u91CD\u590D\u6DFB\u52A0\u5C42\u7EA7 type:" + layerType + ",name:" + layer.layerName);
            return false;
        }
        this._layerMap.set(layerType, layer);
        if (this._root) {
            layer.onAdd(this._root);
        }
        return true;
    };
    LayerMgr.prototype.removeLayer = function (layerType) {
        if (!this._layerMap || !this._layerMap.has(layerType)) {
            return false;
        }
        var layer = this._layerMap.get(layerType);
        layer.onDestroy && layer.onDestroy();
        this._layerMap.delete(layerType);
        return true;
    };
    LayerMgr.prototype.hideLayer = function (layerType) {
        var layer = this.getLayerByType(layerType);
        if (layer) {
            layer.onHide();
        }
    };
    LayerMgr.prototype.showLayer = function (layerType) {
        var layer = this.getLayerByType(layerType);
        if (layer) {
            layer.onShow();
        }
    };
    LayerMgr.prototype.addNodeToLayer = function (node, layerType) {
        var layer = this.getLayerByType(layerType);
        if (layer) {
            layer.onNodeAdd(node);
        }
    };
    LayerMgr.prototype.getLayerByType = function (layerType) {
        var layer = this._layerMap.get(layerType);
        if (!layer) {
            console.warn("\u3010\u5C42\u7EA7\u7BA1\u7406\u5668\u3011\u6CA1\u6709\u8FD9\u4E2A\u5C42\u7EA7:" + this.layerEnum[layerType] + "," + layerType);
        }
        return layer;
    };
    return LayerMgr;
}());

export { LayerMgr };

    
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXgubWpzIiwic291cmNlcyI6WyJAYWlsaGMvbGF5ZXIvc3JjL2xheWVyLW1nci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJ0eXBlIExheWVyQ2xhc3NUeXBlID0gbGF5ZXIuTGF5ZXJDbGFzc1R5cGU7XHJcblxyXG5leHBvcnQgY2xhc3MgTGF5ZXJNZ3I8VD4gaW1wbGVtZW50cyBsYXllci5JTWdyPFQ+IHtcclxuXHJcblxyXG4gICAgcHJvdGVjdGVkIGxheWVyRW51bTogYW55O1xyXG4gICAgcHJvdGVjdGVkIGNsYXNzTWFwOiBNYXA8c3RyaW5nLCBMYXllckNsYXNzVHlwZT47XHJcbiAgICBwcm90ZWN0ZWQgZGVmYXVsdFR5cGU6IExheWVyQ2xhc3NUeXBlO1xyXG4gICAgcHJvdGVjdGVkIF9sYXllck1hcDogTWFwPG51bWJlciwgbGF5ZXIuSUxheWVyIHwgYW55PjtcclxuICAgIHByaXZhdGUgX3Jvb3Q6IFQ7XHJcblxyXG4gICAgcHVibGljIGluaXQobGF5ZXJFbnVtOiBhbnksXHJcbiAgICAgICAgZGVmYXVsdENsYXNzOiBMYXllckNsYXNzVHlwZVxyXG4gICAgICAgICwgY2xhc3NNYXA/OiBNYXA8c3RyaW5nLCBMYXllckNsYXNzVHlwZT5cclxuICAgICAgICAsIHJvb3Q/OiBUKSB7XHJcbiAgICAgICAgaWYgKHJvb3QpIHRoaXMuX3Jvb3QgPSByb290O1xyXG4gICAgICAgIHRoaXMubGF5ZXJFbnVtID0gbGF5ZXJFbnVtO1xyXG4gICAgICAgIHRoaXMuZGVmYXVsdFR5cGUgPSBkZWZhdWx0Q2xhc3M7XHJcbiAgICAgICAgdGhpcy5jbGFzc01hcCA9IGNsYXNzTWFwO1xyXG4gICAgICAgIGNvbnN0IGxlbiA9IE9iamVjdC5rZXlzKGxheWVyRW51bSkubGVuZ3RoIC8gMjtcclxuICAgICAgICBsZXQgbGF5ZXJDbGFzc05hbWVBbmRMYXllck5hbWU6IHN0cmluZ1tdO1xyXG4gICAgICAgIGxldCBsYXllck5hbWU6IHN0cmluZztcclxuICAgICAgICBsZXQgbGF5ZXI6IGxheWVyLklMYXllcjtcclxuICAgICAgICBsZXQgY2xhczogTGF5ZXJDbGFzc1R5cGU7XHJcbiAgICAgICAgbGV0IGNsYXNzTmFtZTogc3RyaW5nO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcclxuICAgICAgICAgICAgbGF5ZXJDbGFzc05hbWVBbmRMYXllck5hbWUgPSBsYXllckVudW1baV0uc3BsaXQoXCJfXCIpO1xyXG4gICAgICAgICAgICBjbGFzc05hbWUgPSBsYXllckNsYXNzTmFtZUFuZExheWVyTmFtZVswXTtcclxuICAgICAgICAgICAgbGF5ZXJOYW1lID0gbGF5ZXJDbGFzc05hbWVBbmRMYXllck5hbWVbMV1cclxuICAgICAgICAgICAgaWYgKCFsYXllck5hbWUpIHtcclxuICAgICAgICAgICAgICAgIGxheWVyTmFtZSA9IGNsYXNzTmFtZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY2xhc3NNYXAgJiYgdGhpcy5jbGFzc01hcC5oYXMoY2xhc3NOYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgY2xhcyA9IHRoaXMuY2xhc3NNYXAuZ2V0KGNsYXNzTmFtZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjbGFzID0gZGVmYXVsdENsYXNzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxheWVyID0gbmV3IGNsYXMoKTtcclxuICAgICAgICAgICAgbGF5ZXIub25Jbml0KGxheWVyTmFtZSwgaSwgdGhpcyk7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkTGF5ZXIobGF5ZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHB1YmxpYyBzZXRMYXllclJvb3Qocm9vdDogVCk6IHZvaWQge1xyXG4gICAgICAgIGlmICghcm9vdCkgcmV0dXJuO1xyXG4gICAgICAgIHRoaXMuX3Jvb3QgPSByb290O1xyXG4gICAgICAgIGlmICh0aGlzLl9sYXllck1hcCkge1xyXG4gICAgICAgICAgICB0aGlzLl9sYXllck1hcC5mb3JFYWNoKCh2YWx1ZTogbGF5ZXIuSUxheWVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZS5vbkFkZChyb290KTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgZ2V0IHJvb3QoKTogVCB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Jvb3Q7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldCBsYXllck1hcCgpOiBNYXA8bnVtYmVyLCBsYXllci5JTGF5ZXIgfCBhbnk+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbGF5ZXJNYXA7XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgYWRkTGF5ZXIobGF5ZXI6IGxheWVyLklMYXllcik6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmICghdGhpcy5fbGF5ZXJNYXApIHtcclxuICAgICAgICAgICAgdGhpcy5fbGF5ZXJNYXAgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGxheWVyVHlwZSA9IGxheWVyLmxheWVyVHlwZTtcclxuICAgICAgICBpZiAodGhpcy5fbGF5ZXJNYXAuaGFzKGxheWVyVHlwZSkpIHtcclxuICAgICAgICAgICAgY29uc29sZS53YXJuKGDjgJDlsYLnuqfnrqHnkIblmajjgJHph43lpI3mt7vliqDlsYLnuqcgdHlwZToke2xheWVyVHlwZX0sbmFtZToke2xheWVyLmxheWVyTmFtZX1gKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9sYXllck1hcC5zZXQobGF5ZXJUeXBlLCBsYXllcik7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Jvb3QpIHtcclxuICAgICAgICAgICAgbGF5ZXIub25BZGQodGhpcy5fcm9vdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcHVibGljIHJlbW92ZUxheWVyKGxheWVyVHlwZTogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9sYXllck1hcCB8fCAhdGhpcy5fbGF5ZXJNYXAuaGFzKGxheWVyVHlwZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBsYXllcjogbGF5ZXIuSUxheWVyID0gdGhpcy5fbGF5ZXJNYXAuZ2V0KGxheWVyVHlwZSk7XHJcbiAgICAgICAgbGF5ZXIub25EZXN0cm95ICYmIGxheWVyLm9uRGVzdHJveSgpO1xyXG4gICAgICAgIHRoaXMuX2xheWVyTWFwLmRlbGV0ZShsYXllclR5cGUpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgcHVibGljIGhpZGVMYXllcihsYXllclR5cGU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGxheWVyID0gdGhpcy5nZXRMYXllckJ5VHlwZShsYXllclR5cGUpO1xyXG4gICAgICAgIGlmIChsYXllcikge1xyXG4gICAgICAgICAgICBsYXllci5vbkhpZGUoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgc2hvd0xheWVyKGxheWVyVHlwZTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgbGF5ZXIgPSB0aGlzLmdldExheWVyQnlUeXBlKGxheWVyVHlwZSk7XHJcbiAgICAgICAgaWYgKGxheWVyKSB7XHJcbiAgICAgICAgICAgIGxheWVyLm9uU2hvdygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHB1YmxpYyBhZGROb2RlVG9MYXllcihub2RlOiBULCBsYXllclR5cGU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGxheWVyID0gdGhpcy5nZXRMYXllckJ5VHlwZShsYXllclR5cGUpO1xyXG4gICAgICAgIGlmIChsYXllcikge1xyXG4gICAgICAgICAgICBsYXllci5vbk5vZGVBZGQobm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRMYXllckJ5VHlwZTxUIGV4dGVuZHMgbGF5ZXIuSUxheWVyPihsYXllclR5cGU6IG51bWJlcik6IFQge1xyXG4gICAgICAgIGNvbnN0IGxheWVyID0gdGhpcy5fbGF5ZXJNYXAuZ2V0KGxheWVyVHlwZSk7XHJcbiAgICAgICAgaWYgKCFsYXllcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYOOAkOWxgue6p+euoeeQhuWZqOOAkeayoeaciei/meS4quWxgue6pzoke3RoaXMubGF5ZXJFbnVtW2xheWVyVHlwZV19LCR7bGF5ZXJUeXBlfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbGF5ZXI7XHJcbiAgICB9XHJcblxyXG5cclxufSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0lBRUE7S0E0R0M7SUFuR1UsdUJBQUksR0FBWCxVQUFZLFNBQWMsRUFDdEIsWUFBNEIsRUFDMUIsUUFBc0MsRUFDdEMsSUFBUTtRQUNWLElBQUksSUFBSTtZQUFFLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO1FBQzVCLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQzNCLElBQUksQ0FBQyxXQUFXLEdBQUcsWUFBWSxDQUFDO1FBQ2hDLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLElBQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztRQUM5QyxJQUFJLDBCQUFvQyxDQUFDO1FBQ3pDLElBQUksU0FBaUIsQ0FBQztRQUN0QixJQUFJLEtBQW1CLENBQUM7UUFDeEIsSUFBSSxJQUFvQixDQUFDO1FBQ3pCLElBQUksU0FBaUIsQ0FBQztRQUN0QixLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQzFCLDBCQUEwQixHQUFHLFNBQVMsQ0FBQyxDQUFD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
