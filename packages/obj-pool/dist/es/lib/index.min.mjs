var o=function(){function o(){}return Object.defineProperty(o.prototype,"poolObjs",{get:function(){return this._poolObjs},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"sign",{get:function(){return this._sign},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"size",{get:function(){var o=this._poolObjs;return o?o.length:0},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"usedCount",{get:function(){return this._usedObjMap?this._usedObjMap.size:0},enumerable:!1,configurable:!0}),o.prototype.initByFunc=function(o,t){return this._sign?this._loghasInit():(this._sign=o,this._poolObjs=[],this._usedObjMap=new Map,this._createFunc=t),this},o.prototype.initByClass=function(o,t){return this._sign?this._loghasInit():(this._sign=o,this._poolObjs=[],this._usedObjMap=new Map,this._createFunc=function(){return new t}),this},o.prototype.setObjHandler=function(o){this._objHandler=o},o.prototype.preCreate=function(o){if(this._sign)for(var t,e=this._poolObjs,i=this._objHandler,n=0;n<o;n++)(t=this._createFunc())&&t.onCreate?t.onCreate(this):i&&i.onCreate&&i.onCreate(t),t.poolSign=this._sign,t.isInPool=!0,e.push(t);else this._logNotInit()},o.prototype.clear=function(){var o=this.poolObjs;if(o){for(var t=void 0,e=0;e<o.length;e++)t=o[e],this.kill(t);o.length=0}},o.prototype.kill=function(o){if(this._usedObjMap.has(o)){var t=this._objHandler;o.onFree?o.onFree():t&&t.onFree&&t.onFree(o),this._usedObjMap.delete(o)}var e=this._objHandler;o&&o.onKill?o.onKill():e&&e.onKill&&e.onKill(o)},o.prototype.free=function(o){if(this._sign)if(o.isInPool)console.warn("pool :"+this._sign+" obj is in pool");else{var t=this._objHandler;o.onFree?o.onFree():t&&t.onFree&&t.onFree(o),this._poolObjs.push(o),this._usedObjMap.delete(o)}else this._logNotInit()},o.prototype.freeAll=function(){var o=this;this._usedObjMap.forEach((function(t){o.free(t)})),this._usedObjMap.clear()},o.prototype.get=function(o){if(this._sign){var t;this.poolObjs.length?t=this._poolObjs.pop():((t=this._createFunc()).onCreate&&t.onCreate(this),t.poolSign=this._sign),this._usedObjMap.set(t,t),t.isInPool=!1;var e=this._objHandler;return t.onGet?t.onGet(o):e&&e.onGet&&e.onGet(t,o),t}this._logNotInit()},o.prototype.getMore=function(o,t){void 0===t&&(t=1);var e=[];if(!isNaN(t)&&t>1)for(var i=0;i<t;i++)e.push(this.get(o));else e.push(this.get(o));return e},o.prototype._loghasInit=function(){console.warn("\u5bf9\u8c61\u6c60"+this._sign+"\u5df2\u7ecf\u521d\u59cb\u5316")},o.prototype._logNotInit=function(){console.error("\u5bf9\u8c61\u6c60\u8fd8\u6ca1\u521d\u59cb\u5316")},o}(),t="\u5bf9\u8c61\u6c60\u4e0d\u5b58\u5728",e="\u5bf9\u8c61\u6c60\u5df2\u5b58\u5728",i="sign is null",n=function(){function n(){this._poolDic={}}return n.prototype.setObjPoolHandler=function(o,t){var e=this._poolDic[o];e&&e.setObjHandler(t)},n.prototype.createByClass=function(t,n){if(this.hasPool(t))this._log(""+e+t);else if(t&&""!==t.trim()){var r=new o;r.initByClass(t,n),this._poolDic[t]=r}else this._log(""+i)},n.prototype.createByFunc=function(t,n){if(this.hasPool(t))this._log(""+e+t);else if(t&&""!==t.trim()){var r=new o;r.initByFunc(t,n),this._poolDic[t]=r}else this._log(""+i)},n.prototype.hasPool=function(o){return!!this._poolDic[o]},n.prototype.getPool=function(o){return this._poolDic[o]},n.prototype.clearPool=function(o){var t=this._poolDic[o];t&&t.clear()},n.prototype.destroyPool=function(o){var e=this._poolDic,i=e[o];i?(i.clear(),e[o]=void 0):this._log(""+t+o)},n.prototype.preCreate=function(o,e){var i=this._poolDic[o];i?i.preCreate(e):this._log(""+t+o)},n.prototype.get=function(o,t){var e=this._poolDic[o];return e?e.get(t):void 0},n.prototype.getMore=function(o,t,e){var i=this._poolDic[o];return i?i.getMore(t,e):void 0},n.prototype.getPoolObjsBySign=function(o){var t=this._poolDic[o];return t?t.poolObjs:void 0},n.prototype.free=function(o){var t=this._poolDic[o.poolSign];t&&t.free(o)},n.prototype.freeAll=function(o){var t=this._poolDic[o];t&&t.freeAll()},n.prototype.kill=function(o){var t=this._poolDic[o.poolSign];t&&t.kill(o)},n.prototype._log=function(o,t){void 0===t&&(t=1);var e="[\u5bf9\u8c61\u6c60\u7ba1\u7406\u5668]";switch(t){case 0:console.log(e+o);break;case 1:console.warn(e+o);case 2:console.error(e+o);default:console.log(e+o)}},n}();export{o as BaseObjPool,n as ObjPoolMgr};
